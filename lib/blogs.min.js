window.W||(window.W=new Array,W.$modules=[]),W.$modules.push(function(r,t,e){function a(r,t){function e(r){if("true"==r)return!0;if("false"==r)return!1;if("null"==r)return null;if(r){var t=parseFloat(r);return t+""===r?t:r}return""}var a=[],n=[],o="";return t.split("\n").forEach(function(r){if((r=r.trim())&&"//"!=r.slice(0,2))return 0==r.search(y)?(o&&(n.push(o),o=""),a.push(n),void(n=[])):0==r.search(C)?(o&&(n.push(o),o=""),void n.push(r.split("="))):void(o?o+=" "+r:o=r);o&&(n.push(o),o="")}),o&&n.push(o),n.length&&a.push(n),0!=a.length&&(a.forEach(function(t){var a={},n=null,o=!1;t.forEach(function(r,t){if(Array.isArray(r)){var i=r[1].trim();i&&(a[r[0]]=e(i),o=!0)}else{var s=[];r.split(m).forEach(function(r){var t,a=r.split(",");t=a.length>1?a.map(function(r){return e(r)}):e(a[0]),s.push(t)}),s.length&&(n=s)}}),r.push([o?a:null,n])}),!0)}function n(r,t){if(t.labels)return t.labels;var e=r.labels;return e&&"string"==typeof e?(e=e.split(",")).length<=1?null:(t.labels=e,delete r.labels,e):null}function o(r){(r.title||{}).text&&(r.title.display=!0)}function i(r){var t=[],e=r.replace(A,function(r){return t.push(r),""});return e&&0!=e.search(w)?r:t.length<=1?t[0]||r:t}function s(r,t,e){function a(r,t){var e=r/t*100,a=e+"",n=a.indexOf(".");return n<=0?" "+a+"%":" "+e.toPrecision(n+1)+"%"}o(r);var n=t.datasets;if(Array.isArray(n)&&0!=n.length){var s=(t.labels||[]).length;if(0!=s){if(e&&r.legend.showPercent)for(f=0;u=n[f];f++)if(Array.isArray(u.data)){var l=0;u.data.forEach(function(r){l+=r}),l&&u.data.forEach(function(r,e){e<s&&(t.labels[e]+=a(r,l))})}for(var u,f=0;u=n[f];f++)u.backgroundColor?u.backgroundColor=i(u.backgroundColor):u.backgroundColor=function(r){for(var t=[],e=0;e<r;e++)t.push("rgba("+_[e%16]+",0.5)");return t}(s)}}}function l(r){function t(r){var e=r.parent,a=e&&e.component;return a?a.props["isScenePage."]?a:t(e):null}function e(){function t(r){a.removeEventListener("slideenter",t),n.state.chart||n.redraw()}function e(){i+=1,setTimeout(function(){if(n.isHooked){if(n.waitRedraw){n.waitRedraw=!1;var t=n.state.data;c.__design__&&(t=Object.assign({},t),b=[],Array.isArray(t.datasets)&&(t.datasets.forEach(function(r){b.push(Object.assign({},r))}),t.datasets=b)),n.state.chart=new window.Chart(d.findDOMNode(n).getContext("2d"),{type:r,data:t,options:n.state.options||{}})}}else i<10&&e()},n.isHooked?100:600)}var a,n=this,o=this.state.chart;if(!o&&this.ownerSlide){if(!this.isHooked)return;if(!(a=this.ownerSlide.getHtmlNode()))return;if("none"==a.style.display)return void a.addEventListener("slideenter",t,!1)}if(o&&(o.destroy(),this.state.chart=void 0),this.state.data){this.waitRedraw=!0;var i=0;e()}}function n(r,t){return function(){return r.state.chart[t].apply(r.state.chart,arguments)}}function o(r,t,e,a,n){t&&setTimeout(function(){r.setChild("-"+e,function(e){var o=[];a&&o.push("+"+a),o.push(t),n&&o.push(n),r.setChild.apply(r,o)})},0)}function i(r,t,e){for(var a=t.split("."),n=a.length,o=n-1,i=r,s=0;s<n;s++){var l=a[s];s<o?i=i.hasOwnProperty(l)?i[l]:s<o&&0==a[s+1].search(/^[0-9]+$/)?i[l]=[]:i[l]={}:0==l.search(/^[0-9]+$/)?i[parseInt(l)]=e:i[l]=e}}return p.loadElement(["Canvas",{key:r,$id__:function(r,s){if(r<=2)if(1==r){this.waitRedraw=!1,this.ownerSlide=this.widget&&t(this.widget),this.renewChart=function(r){var t=this.parentOf();if(t){var e=null,a="",n=this.duals.keyid+"",i=t.$gui.compIdx[n];if(!isNaN(i)&&i>=0)for(e=t.$gui.comps[i];++i<t.$gui.comps.length;){var s=t.$gui.comps[i];if(s){a=p.keyOfElement(s);break}}o(t,e,n,a,r)}},this.redraw=e,this.getChart=function(){return this.state.chart};for(var l,u=0;l=k[u];u++)this[l]=n(this,l);this.defineDual("data",function(r,t){this.redraw()}),this.defineDual("options",function(r,t){this.redraw()}),this.defineDual("html.",function(r,t){var e=this.parentOf(),n=[],o=this.duals.keyid;if(e&&e.props["data-dsn-sizes"]===o&&a(n,r)&&!(n.length<=1)){var s=E[o];if(s){var l={},u=n[0][0];s.defaultCfg.forEach(function(r){i(l,r[0],r[1])}),u&&Object.keys(u).forEach(function(r){i(l,r,u[r])});var f=[],d={datasets:f};if(!s.scanLabels||s.scanLabels(l,d)){for(var c,h=1;c=n[h];h++){var p=c[1];if(Array.isArray(p)){var g={data:p},v=c[0];v&&Object.keys(v).forEach(function(r){i(g,r,v[r])}),f.push(g)}}s.adjustData&&s.adjustData(l,d),this.duals.data=d,this.duals.options=l}}}})}else if(2==r){if(c.__design__){var f=this.parentOf();if(f&&f.props["data-dsn-sizes"]===this.duals.keyid){var d=f.$gui,h=this;d.chartWd=d.cssWidth,d.chartHi=d.cssHeight,f.listen("id__",function(r,t){r<=2||!h.isHooked||d.chartWd===d.cssWidth&&d.chartHi===d.cssHeight||(d.chartWd=d.cssWidth,d.chartHi=d.cssHeight,h.renewChart())})}}this.waitRedraw||this.redraw()}else if(0==r){var g=this.state.chart;this.state.chart=void 0,g&&g.destroy(),this.ownerSlide=null}}}])}function u(r){var t=["P",{key:r,$id__:function(r,t){if(r<=2&&2==r){var e=!this.props.noShow;c.__design__&&!e?this.duals.style={opacity:"0.2"}:this.duals.style={opacity:e?"1":"0"}}}}];return p.loadElement(t)}var f=r("react"),d=r("react-dom"),c=r("shadow-widget"),h=c.$main,p=c.$utils,g=(c.$ex,c.$idSetter),v=c.$creator;g[".pinp.blog.version"]=function(){return"1.1.2"};var y=/^---+$/,C=/^[$_a-zA-Z][$_.a-zA-Z0-9]*=/,m=/[^-+,._A-Za-z0-9]+/,k=["clear","stop","resize","reset","toBase64Image","generateLegend","update","getElementAtEvent","getElementsAtEvent","getDatasetAtEvent","getDatasetMeta"],_=["51,153,102","153,102,0","51,102,153","192,0,0","102,102,51","255,204,102","102,153,0","204,0,153","102,0,153","51,102,204","153,51,51","51,204,0","204,102,0","102,102,153","51,153,255","102,51,51"],A=/#[a-fA-F0-9]+|rgb\([^)]+\)|rgba\([^)]+\)|hsl\([^)]+\)|[a-z]+/g,w=/^[ ,]*$/,E={line1:{defaultCfg:[["elements.point.backgroundColor","#fff"],["elements.point.hoverRadius",4]],scanLabels:n,adjustData:function(r,t){o(r);var e=t.datasets;if(Array.isArray(e))for(var a,n=0;a=e[n];n++){var s=_[n%16];a.backgroundColor?a.backgroundColor=i(a.backgroundColor):a.backgroundColor="rgba("+s+",0.16)",a.borderColor?a.borderColor=i(a.borderColor):a.borderColor="rgba("+s+",0.7)",a.pointBorderColor?a.pointBorderColor=i(a.pointBorderColor):a.pointBorderColor="rgba("+s+",0.7)"}}},line2:{defaultCfg:[["elements.point.backgroundColor","#fff"],["elements.point.hoverRadius",4],["scales.xAxes.0.type","linear"]],adjustData:function(r,t){o(r);var e=t.datasets;if(Array.isArray(e))for(var a,n=0;a=e[n];n++){var s=_[n%16];a.backgroundColor?a.backgroundColor=i(a.backgroundColor):a.backgroundColor="rgba("+s+",0.16)",a.borderColor?a.borderColor=i(a.borderColor):a.borderColor="rgba("+s+",0.7)",a.pointBorderColor?a.pointBorderColor=i(a.pointBorderColor):a.pointBorderColor="rgba("+s+",0.7)";var l=[],u=a.data;Array.isArray(u)&&u.forEach(function(r){Array.isArray(r)&&2==r.length&&l.push({x:r[0],y:r[1]})}),a.data=l}}},bar1:{defaultCfg:[["scales.yAxes.0.ticks.beginAtZero",!0]],scanLabels:n,adjustData:function(r,t){o(r);var e,a=t.datasets;if(Array.isArray(a)&&0!=a.length){var n=(t.labels||[]).length;if(0!=n)if(1==a.length&&"line"!==(e=a[0]).type){if(e.backgroundColor)e.backgroundColor=i(e.backgroundColor);else{for(var s=[],l=0;l<n;l++)s.push("rgba("+_[(l+1)%16]+",0.22)");e.backgroundColor=s}if(e.borderColor)e.borderColor=i(e.borderColor);else{for(var s=[],l=0;l<n;l++)s.push("rgba("+_[l%16]+",0.7)");e.borderColor=s}}else for(var u=0;e=a[u];u++){var f=_[u%16];e.backgroundColor?e.backgroundColor=i(e.backgroundColor):e.backgroundColor="rgba("+f+",0.3)",e.borderColor?e.borderColor=i(e.borderColor):e.borderColor="rgba("+f+",0.7)",e.pointBorderColor?e.pointBorderColor=i(e.pointBorderColor):e.pointBorderColor="rgba("+f+",0.7)"}}}},radar1:{defaultCfg:[["elements.point.backgroundColor","#fff"],["elements.point.hoverRadius",5]],scanLabels:n,adjustData:function(r,t){o(r);var e,a=t.datasets;if(Array.isArray(a)&&0!=a.length&&0!=(t.labels||[]).length)for(var n=0;e=a[n];n++){var s=_[n%16];e.backgroundColor?e.backgroundColor=i(e.backgroundColor):e.backgroundColor="rgba("+s+",0.2)",e.borderColor?e.borderColor=i(e.borderColor):e.borderColor="rgba("+s+",0.8)",e.pointBorderColor?e.pointBorderColor=i(e.pointBorderColor):e.pointBorderColor="rgba("+s+",0.8)"}}},polarArea1:{defaultCfg:[],scanLabels:n,adjustData:s},pie1:{defaultCfg:[],scanLabels:n,adjustData:function(r,t){s(r,t,!0)}},doughnut1:{defaultCfg:[],scanLabels:n,adjustData:function(r,t){s(r,t,!0)}},bubble1:{defaultCfg:[],adjustData:function(r,t){o(r);var e=t.datasets;if(Array.isArray(e))for(var a,n=0;a=e[n];n++){var s=_[n%16];a.backgroundColor?a.backgroundColor=i(a.backgroundColor):a.backgroundColor="rgba("+s+",0.5)";var l=[],u=a.data;Array.isArray(u)&&u.forEach(function(r){Array.isArray(r)&&3==r.length&&l.push({x:r[0],y:r[1],r:r[2]})}),a.data=l}}}};g[".pinp.mini_audio"]=function(r,t){function e(r,t){r.duals.style={backgroundImage:"url("+(t?r.props.playImg:r.props.idleImg)+")"}}if(r<=2){if(1==r){var a=this.props.playImg,n=this.props.idleImg;this.stateImgReady=a&&"string"==typeof a&&n&&"string"==typeof n,this.duals.style={backgroundRepeat:"no-repeat",backgroundSize:"100% 100%",overflow:"hidden"},c.__design__||this.setEvent({$onClick:function(r){var t=this.componentOf("player");t&&(t.duals.playing?"function"==typeof t.stepPause&&t.stepPause(""):"function"==typeof t.stepPlay&&t.stepPlay(0))}})}else if(2==r&&this.stateImgReady){if(!c.__design__){var o=this.componentOf("player"),i=!1;if(o&&void 0!==(i=o.duals.playing)){var s=this;o.listen("playing",function(r,t){e(s,r)})}}e(this,i)}}else;},g[".pinp.mini_audio.player"]=function(r,t){r<=2&&1==r&&(this.defineDual("playing",null,!1),c.__design__?this.duals.style={width:"100%",opacity:"0.08"}:(this.setEvent({$onPlay:function(r){this.duals.playing=!0},$onPause:function(r){this.duals.playing=!1}}),this.duals.style={visibility:"hidden"}))};var $=null,O=null,B=null;if(h.$$onLoad.push(function(r){var t;!$&&c.__design__&&(t=c.$templates.rewgt)&&(t=t.DrawPaper)&&!t._tools&&($=v.containNode_,t._tools=[{name:"editor",icon:"/blogs/output/res/edit_txt.png",title:"edit paper",url:"/blogs/output/edit_paper.html",halfScreen:!0,noMove:!0,clickable:!0,width:.9999,height:.9999,get:function(r){var t=[],e=r.widget,a=e.getPath();return $.dumpTree(t,e,e.parent.getPath()),[a,t[0],!!r.props["data-inline"]]},set:function(r,t,e){function a(r,t){function e(){c.__design__&&$.notifyBackup&&$.notifyBackup(o,1e3)}t.length?(t.push(e),r.setChild.apply(r,t)):e()}var n=t[0],o=t[1],i=t[2];if(n&&r.widget.getPath()==o&&Array.isArray(i)&&i.length-1>=0){var s=i[0];if(Array.isArray(s)&&s.length>=2){var l=s[1];r.duals.offsetX=l.offsetX||0,r.duals.offsetY=l.offsetY||0}var u=p.loadElement(i),d=f.Children.toArray(u.props.children),h=[];r.$gui.comps.forEach(function(r){var t=p.keyOfElement(r);t&&h.push("-"+t)}),h.length?r.setChild(h,function(t){a(r,d)}):a(r,d)}}}]),window.Chart?p.setVendorLib("pinp",function(t){O||(O=p.loadElement([["P",{key:"charts"}],l("line"),l("bar"),l("radar"),l("polarArea"),l("pie"),l("doughnut"),l("bubble")])),B||(B=p.loadElement([["Div",{key:"doc_info"}],u("title"),u("desc"),u("keyword"),u("thumb")])),t.setChild(O,B,function(t){r()})}):r()}),!c.__design__){var D=["width","height","left","top"];h.$onLoad.push(function(){function r(i,s,l,c,h){var p=Object.keys(l).sort();if(!p.length)return s;for(var g=[];p.length;){var v=p.pop();if(v&&"."!=v[0]){var b=l[v];if(c.indexOf("/"+b+"/")>=0)e(b);else{var y=v.split(".").pop(),C=!1,m=n(s,v);if(!m||!y||0==y.search(/^[0-9]+$/)&&(C=!0))C&&console.log("error: invalid name ("+sName+")"),t(i+"."+v);else{var k=u.elementOf(b);if(k){var _=d[b];if(_){if(w=r(b,k,_,c+b+"/",{})){var A=f.cloneElement(w,a(w.props,m.props,y));g.unshift([v,A])}}else{var w=f.cloneElement(k,a(k.props,m.props,y));g.unshift([v,w])}}else t(b)}}}}if(!g.length)return s;for(var E=null,$="/",O=[];g.length;){var B,D,P=g.pop(),j=P[0],x=j.lastIndexOf(".");if(x>=0?(B=j.slice(0,x),D=j.slice(x+1)):(B="",D=j),"/"==$&&($=B),B!=$){if(!(I=o(h,i,s,$,O,E)))return null;E=[$,I],$=B,O=[]}O.unshift([D,P[1]])}var I=o(h,i,s,$,O,E);return I?$?(E=[$,I],o(h,i,s,"",[],E)):I:null}function t(r){console.log("warning: can not find element ("+r+")")}function e(r){console.log("warning: recursive link element ("+r+")")}function a(r,t,e){var a={};return t.style&&(a.style=Object.assign({},r.style,t.style)),D.forEach(function(r){t.hasOwnProperty(r)&&(a[r]=t[r])}),e&&(a.key=e),a}function n(r,t){for(var e=t.split(".");e.length;){var a=e.shift();if(!(r=f.Children.toArray(r.props.children).find(function(r){return p.keyOfElement(r)==a})))return null}return r}function o(r,e,a,n,o,s){for(;s;){var l,u=s[0],d=s[1],c="",h=u.lastIndexOf(".");if(h<0?l=u:(l=u.slice(h+1),c=u.slice(0,h)),c==n){o.push([l,d]);break}if(!c)return null;var g=i(r,e,a,c);if(!g)return null;var v=f.Children.toArray(g.props.children);if((h=v.findIndex(function(r){return p.keyOfElement(r)==l}))<0)return t(u),null;v.splice(h,1,d),v.unshift(g,{}),s=[c,f.cloneElement.apply(null,v)]}var b=i(r,e,a,n);if(!b)return null;if(!o.length)return b;var y=f.Children.toArray(b.props.children);return o.forEach(function(r){var e=r[0],a=y.findIndex(function(r){return p.keyOfElement(r)==e});a<0?t(u):y.splice(a,1,r[1])}),y.length?(y.unshift(b,{}),f.cloneElement.apply(null,y)):b}function i(r,e,a,n){if(!n)return a;var o=r[n];if(o)return o;for(var i=n.split("."),s="";i.length;){var l=i.shift();s?s+="."+l:s=l;var u,f=r[s];if(f)a=f;else{if(!Array.isArray(u=a.props.children)||!(f=u.find(function(r){return p.keyOfElement(r)==l})))return t(e+"."+s),null;a=r[s]=f}}return a}var s=p.pageCtrl;if(!(s&&s.keys.length>0)){var l=v.topmostWidget_,u=l&&l.component;if(u){for(var d=null,c=u.$gui.comps||[],h=c.length,g=0;g<h;g++){var b=c[g];if(b&&b.props["isScenePage."]){var y=p.keyOfElement(b),C=y&&l[y];if(C=C&&C.component){if(C.props.noShow){var m=C.elementOf("link_table");if(m)try{d=JSON.parse(m.props["html."]||"{}")}catch(r){console.log("fatal error: parse json of link_table failed")}}break}}}if(d){var k=d.root;if(!Array.isArray(k))return;var _=[];k.forEach(function(e){var a=u.elementOf(e);if(a){var n=d[e];if(n){var o=r(e,a,n,"/"+e+"/",{});o&&_.push(o)}else _.push(a)}else t(e)}),_.length&&u.setChild.apply(u,_)}}}})}});