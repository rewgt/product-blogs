window.W||(window.W=new Array,W.$modules=[]),W.$modules.push(function(a,c,d){function p(a,b){function g(a){if("true"==a)return!0;if("false"==a)return!1;if("null"==a)return null;if(a){var b=parseFloat(a);return b+""===a?b:a}return""}var c=b.split("\n"),d=[],e=[],f="";return c.forEach(function(a){return(a=a.trim())&&"//"!=a.slice(0,2)?0==a.search(m)?(f&&(e.push(f),f=""),d.push(e),void(e=[])):0==a.search(n)?(f&&(e.push(f),f=""),void e.push(a.split("="))):void(f?f+=" "+a:f=a):void(f&&(e.push(f),f=""))}),f&&e.push(f),e.length&&d.push(e),0!=d.length&&(d.forEach(function(b){var c={},d=null,e=!1;b.forEach(function(a,b){if(Array.isArray(a)){var f=a[1].trim();f&&(c[a[0]]=g(f),e=!0)}else{var h=a.split(o),i=[];h.forEach(function(a){var b,c=a.split(",");b=c.length>1?c.map(function(a){return g(a)}):g(c[0]),i.push(b)}),i.length&&(d=i)}}),a.push([e?c:null,d])}),!0)}function u(a,b){if(b.labels)return b.labels;var c=a.labels;return c&&"string"==typeof c?(c=c.split(","),c.length<=1?null:(b.labels=c,delete a.labels,c)):null}function v(a){(a.title||{}).text&&(a.title.display=!0)}function w(a){var b=[],c=a.replace(s,function(a){return b.push(a),""});return c&&0!=c.search(t)?a:b.length<=1?b[0]||a:b}function x(a,b,c){function i(a){for(var b=[],c=0;c<a;c++)b.push("rgba("+r[c%16]+",0.5)");return b}function j(a,b){var c=a/b*100,d=c+"",e=d.indexOf(".");return e<=0?" "+d+"%":" "+c.toPrecision(e+1)+"%"}v(a);var d=b.datasets;if(Array.isArray(d)&&0!=d.length){var e=(b.labels||[]).length;if(0!=e){if(c&&a.legend.showPercent)for(var g,f=0;g=d[f];f++)if(Array.isArray(g.data)){var h=0;g.data.forEach(function(a){h+=a}),h&&g.data.forEach(function(a,c){c<e&&(b.labels[c]+=j(a,h))})}for(var g,f=0;g=d[f];f++)g.backgroundColor?g.backgroundColor=w(g.backgroundColor):g.backgroundColor=i(e)}}}function z(a){function c(a,b){if(a<=2){if(1==a){this.waitRedraw=!1,this.ownerSlide=this.widget&&d(this.widget),this.renewChart=function(a){var b=this.parentOf();if(b){var c=null,d="",e=this.duals.keyid+"",f=b.$gui.compIdx[e];if(!isNaN(f)&&f>=0)for(c=b.$gui.comps[f];++f<b.$gui.comps.length;){var g=b.$gui.comps[f];if(g){d=i.keyOfElement(g);break}}j(b,c,e,d,a)}},this.redraw=e,this.getChart=function(){return this.state.chart};for(var f,c=0;f=q[c];c++)this[f]=h(this,f);this.defineDual("data",function(a,b){this.redraw()}),this.defineDual("options",function(a,b){this.redraw()}),this.defineDual("html.",function(a,b){var c=this.parentOf(),d=[],e=this.duals.keyid;if(c&&c.props["data-dsn-sizes"]===e&&p(d,a)&&!(d.length<=1)){var f=y[e];if(f){var g={},h=d[0][0];f.defaultCfg.forEach(function(a){k(g,a[0],a[1])}),h&&Object.keys(h).forEach(function(a){k(g,a,h[a])});var i=[],j={datasets:i};if(!f.scanLabels||f.scanLabels(g,j)){for(var m,l=1;m=d[l];l++){var n=m[1];if(Array.isArray(n)){var o={data:n},q=m[0];q&&Object.keys(q).forEach(function(a){k(o,a,q[a])}),i.push(o)}}f.adjustData&&f.adjustData(g,j),this.duals.data=j,this.duals.options=g}}}})}else if(2==a){if(g.__design__){var m=this.parentOf();if(m&&m.props["data-dsn-sizes"]===this.duals.keyid){var n=m.$gui,o=this;n.chartWd=n.cssWidth,n.chartHi=n.cssHeight,m.listen("id__",function(a,b){a<=2||!o.isHooked||n.chartWd===n.cssWidth&&n.chartHi===n.cssHeight||(n.chartWd=n.cssWidth,n.chartHi=n.cssHeight,o.renewChart())})}}this.waitRedraw||this.redraw()}else if(0==a){var r=this.state.chart;this.state.chart=void 0,r&&r.destroy(),this.ownerSlide=null}}else;}function d(a){var b=a.parent,c=b&&b.component;return c?c.props["isScenePage."]?c:d(b):null}function e(){function e(a){c.removeEventListener("slideenter",e),d.state.chart||d.redraw()}function j(){i+=1,setTimeout(function(){if(!d.isHooked)return void(i<10&&j());if(d.waitRedraw){d.waitRedraw=!1;var c=d.state.data;g.__design__&&(c=Object.assign({},c),b=[],Array.isArray(c.datasets)&&(c.datasets.forEach(function(a){b.push(Object.assign({},a))}),c.datasets=b)),d.state.chart=new window.Chart(f.findDOMNode(d).getContext("2d"),{type:a,data:c,options:d.state.options||{}})}},d.isHooked?100:600)}var c,d=this,h=this.state.chart;if(!h&&this.ownerSlide){if(!this.isHooked)return;if(!(c=this.ownerSlide.getHtmlNode()))return;if("none"==c.style.display)return void c.addEventListener("slideenter",e,!1)}if(h&&(h.destroy(),this.state.chart=void 0),this.state.data){this.waitRedraw=!0;var i=0;j()}}function h(a,b){return function(){return a.state.chart[b].apply(a.state.chart,arguments)}}function j(a,b,c,d,e){b&&setTimeout(function(){a.setChild("-"+c,function(c){var f=[];d&&f.push("+"+d),f.push(b),e&&f.push(e),a.setChild.apply(a,f)})},0)}function k(a,b,c){for(var d=b.split("."),e=d.length,f=e-1,g=a,h=0;h<e;h++){var i=d[h];h<f?g=g.hasOwnProperty(i)?g[i]:h<f&&0==d[h+1].search(/^[0-9]+$/)?g[i]=[]:g[i]={}:0==i.search(/^[0-9]+$/)?g[parseInt(i)]=c:g[i]=c}}return i.loadElement(["Canvas",{key:a,$id__:c}])}function A(a){function c(a,b){if(a<=2){if(2==a){var c=!this.props.noShow;g.__design__&&!c?this.duals.style={opacity:"0.2"}:this.duals.style={opacity:c?"1":"0"}}}else;}var b=["P",{key:a,$id__:c}];return i.loadElement(b)}var e=a("react"),f=a("react-dom"),g=a("shadow-widget"),h=g.$main,i=g.$utils,k=(g.$ex,g.$idSetter),l=g.$creator,m=/^---+$/,n=/^[$_a-zA-Z][$_.a-zA-Z0-9]*=/,o=/[^-+,._A-Za-z0-9]+/,q=["clear","stop","resize","reset","toBase64Image","generateLegend","update","getElementAtEvent","getElementsAtEvent","getDatasetAtEvent","getDatasetMeta"],r=["51,153,102","153,102,0","51,102,153","192,0,0","102,102,51","255,204,102","102,153,0","204,0,153","102,0,153","51,102,204","153,51,51","51,204,0","204,102,0","102,102,153","51,153,255","102,51,51"],s=/#[a-fA-F0-9]+|rgb\([^)]+\)|rgba\([^)]+\)|hsl\([^)]+\)|[a-z]+/g,t=/^[ ,]*$/,y={line1:{defaultCfg:[["elements.point.backgroundColor","#fff"],["elements.point.hoverRadius",4]],scanLabels:u,adjustData:function(a,b){v(a);var c=b.datasets;if(Array.isArray(c))for(var e,d=0;e=c[d];d++){var f=r[d%16];e.backgroundColor?e.backgroundColor=w(e.backgroundColor):e.backgroundColor="rgba("+f+",0.16)",e.borderColor?e.borderColor=w(e.borderColor):e.borderColor="rgba("+f+",0.7)",e.pointBorderColor?e.pointBorderColor=w(e.pointBorderColor):e.pointBorderColor="rgba("+f+",0.7)"}}},line2:{defaultCfg:[["elements.point.backgroundColor","#fff"],["elements.point.hoverRadius",4],["scales.xAxes.0.type","linear"]],adjustData:function(a,b){v(a);var c=b.datasets;if(Array.isArray(c))for(var e,d=0;e=c[d];d++){var f=r[d%16];e.backgroundColor?e.backgroundColor=w(e.backgroundColor):e.backgroundColor="rgba("+f+",0.16)",e.borderColor?e.borderColor=w(e.borderColor):e.borderColor="rgba("+f+",0.7)",e.pointBorderColor?e.pointBorderColor=w(e.pointBorderColor):e.pointBorderColor="rgba("+f+",0.7)";var g=[],h=e.data;Array.isArray(h)&&h.forEach(function(a){Array.isArray(a)&&2==a.length&&g.push({x:a[0],y:a[1]})}),e.data=g}}},bar1:{defaultCfg:[["scales.yAxes.0.ticks.beginAtZero",!0]],scanLabels:u,adjustData:function(a,b){v(a);var c,d=b.datasets;if(Array.isArray(d)&&0!=d.length){var e=(b.labels||[]).length;if(0!=e)if(1==d.length&&"line"!==(c=d[0]).type){if(c.backgroundColor)c.backgroundColor=w(c.backgroundColor);else{for(var f=[],g=0;g<e;g++)f.push("rgba("+r[(g+1)%16]+",0.22)");c.backgroundColor=f}if(c.borderColor)c.borderColor=w(c.borderColor);else{for(var f=[],g=0;g<e;g++)f.push("rgba("+r[g%16]+",0.7)");c.borderColor=f}}else for(var h=0;c=d[h];h++){var i=r[h%16];c.backgroundColor?c.backgroundColor=w(c.backgroundColor):c.backgroundColor="rgba("+i+",0.3)",c.borderColor?c.borderColor=w(c.borderColor):c.borderColor="rgba("+i+",0.7)",c.pointBorderColor?c.pointBorderColor=w(c.pointBorderColor):c.pointBorderColor="rgba("+i+",0.7)"}}}},radar1:{defaultCfg:[["elements.point.backgroundColor","#fff"],["elements.point.hoverRadius",5]],scanLabels:u,adjustData:function(a,b){v(a);var c,d=b.datasets;if(Array.isArray(d)&&0!=d.length){if(0!=(b.labels||[]).length)for(var f=0;c=d[f];f++){var g=r[f%16];c.backgroundColor?c.backgroundColor=w(c.backgroundColor):c.backgroundColor="rgba("+g+",0.2)",c.borderColor?c.borderColor=w(c.borderColor):c.borderColor="rgba("+g+",0.8)",c.pointBorderColor?c.pointBorderColor=w(c.pointBorderColor):c.pointBorderColor="rgba("+g+",0.8)"}}}},polarArea1:{defaultCfg:[],scanLabels:u,adjustData:x},pie1:{defaultCfg:[],scanLabels:u,adjustData:function(a,b){x(a,b,!0)}},doughnut1:{defaultCfg:[],scanLabels:u,adjustData:function(a,b){x(a,b,!0)}},bubble1:{defaultCfg:[],adjustData:function(a,b){v(a);var c=b.datasets;if(Array.isArray(c))for(var e,d=0;e=c[d];d++){var f=r[d%16];e.backgroundColor?e.backgroundColor=w(e.backgroundColor):e.backgroundColor="rgba("+f+",0.5)";var g=[],h=e.data;Array.isArray(h)&&h.forEach(function(a){Array.isArray(a)&&3==a.length&&g.push({x:a[0],y:a[1],r:a[2]})}),e.data=g}}}};k[".pinp.mini_audio"]=function(a,b){function i(a,b){a.duals.style={backgroundImage:"url("+(b?a.props.playImg:a.props.idleImg)+")"}}if(a<=2){if(1==a){var c=this.props.playImg,d=this.props.idleImg;this.stateImgReady=c&&"string"==typeof c&&d&&"string"==typeof d,this.duals.style={backgroundRepeat:"no-repeat",backgroundSize:"100% 100%",overflow:"hidden"},g.__design__||this.setEvent({$onClick:function(a){var b=this.componentOf("player");b&&(b.duals.playing?"function"==typeof b.stepPause&&b.stepPause(""):"function"==typeof b.stepPlay&&b.stepPlay(0))}})}else if(2==a&&this.stateImgReady){if(!g.__design__){var e=this.componentOf("player"),f=!1;if(e&&void 0!==(f=e.duals.playing)){var h=this;e.listen("playing",function(a,b){i(h,a)})}}i(this,f)}}else;},k[".pinp.mini_audio.player"]=function(a,b){if(a<=2)return void(1==a&&(this.defineDual("playing",null,!1),g.__design__?this.duals.style={width:"100%",opacity:"0.08"}:(this.setEvent({$onPlay:function(a){this.duals.playing=!0},$onPause:function(a){this.duals.playing=!1}}),this.duals.style={visibility:"hidden"})))};var B=null,C=null,D=null;if(h.$$onLoad.push(function(a){var b;!B&&g.__design__&&(b=g.$templates.rewgt)&&(b=b.DrawPaper)&&!b._tools&&(B=l.containNode_,b._tools=[{name:"editor",icon:"/blogs/output/res/edit_txt.png",title:"edit paper",url:"/blogs/output/edit_paper.html",halfScreen:!0,noMove:!0,clickable:!0,width:.9999,height:.9999,get:function(a){var b=[],c=a.widget,d=c.getPath();return B.dumpTree(b,c,c.parent.getPath()),[d,b[0],!!a.props["data-inline"]]},set:function(a,b,c){function q(a,b){function c(){g.__design__&&B.notifyBackup&&B.notifyBackup(f,1e3)}b.length?(b.push(c),a.setChild.apply(a,b)):c()}var d=b[0],f=b[1],h=b[2];if(d&&a.widget.getPath()==f&&Array.isArray(h)){if(h.length-1>=0){var k=h[0];if(Array.isArray(k)&&k.length>=2){var l=k[1];a.duals.offsetX=l.offsetX||0,a.duals.offsetY=l.offsetY||0}var m=i.loadElement(h),n=e.Children.toArray(m.props.children),o=[];a.$gui.comps.forEach(function(a){var b=i.keyOfElement(a);b&&o.push("-"+b)}),o.length?a.setChild(o,function(b){q(a,n,f)}):q(a,n,f)}}}}]),window.Chart?i.setVendorLib("pinp",function(b){C||(C=i.loadElement([["P",{key:"charts"}],z("line"),z("bar"),z("radar"),z("polarArea"),z("pie"),z("doughnut"),z("bubble")])),D||(D=i.loadElement([["Div",{key:"doc_info"}],A("title"),A("desc"),A("keyword"),A("thumb")])),b.setChild(C,D,function(b){a()})}):a()}),!g.__design__){var E=["width","height","left","top"];h.$onLoad.push(function(){function q(a,b,f,g,h){var i=Object.keys(f).sort();if(!i.length)return b;for(var j=[];i.length;){var k=i.pop();if(k&&"."!=k[0]){var l=f[k];if(g.indexOf("/"+l+"/")>=0)s(l);else{var m=k.split(".").pop(),n=!1,o=u(b,k);if(!o||!m||0==m.search(/^[0-9]+$/)&&(n=!0))n&&console.log("error: invalid name ("+sName+")"),r(a+"."+k);else{var p=c.elementOf(l);if(p){var w=d[l];if(w){var x=q(l,p,w,g+l+"/",{});if(x){var y=e.cloneElement(x,t(x.props,o.props,m));j.unshift([k,y])}}else{var x=e.cloneElement(p,t(p.props,o.props,m));j.unshift([k,x])}}else r(l)}}}}if(!j.length)return b;for(var z=null,A="/",B=[];j.length;){var E,F,C=j.pop(),D=C[0],G=D.lastIndexOf(".");if(G>=0?(E=D.slice(0,G),F=D.slice(G+1)):(E="",F=D),"/"==A&&(A=E),E!=A){var H=v(h,a,b,A,B,z);if(!H)return null;z=[A,H],A=E,B=[]}B.unshift([F,C[1]])}var H=v(h,a,b,A,B,z);return H?A?(z=[A,H],v(h,a,b,"",[],z)):H:null}function r(a){console.log("warning: can not find element ("+a+")")}function s(a){console.log("warning: recursive link element ("+a+")")}function t(a,b,c){var d={};return b.style&&(d.style=Object.assign({},a.style,b.style)),E.forEach(function(a){b.hasOwnProperty(a)&&(d[a]=b[a])}),c&&(d.key=c),d}function u(a,b){for(var c=b.split(".");c.length;){var d=c.shift();if(!(a=e.Children.toArray(a.props.children).find(function(a){return i.keyOfElement(a)==d})))return null}return a}function v(a,b,c,d,f,g){for(;g;){var k,h=g[0],j=g[1],l="",m=h.lastIndexOf(".");if(m<0?k=h:(k=h.slice(m+1),l=h.slice(0,m)),l==d){f.push([k,j]);break}if(!l)return null;var n=w(a,b,c,l);if(!n)return null;var o=e.Children.toArray(n.props.children);if((m=o.findIndex(function(a){return i.keyOfElement(a)==k}))<0)return r(h),null;o.splice(m,1,j),o.unshift(n,{}),g=[l,e.cloneElement.apply(null,o)]}var p=w(a,b,c,d);if(!p)return null;if(!f.length)return p;var q=e.Children.toArray(p.props.children);return f.forEach(function(a){var b=a[0],c=q.findIndex(function(a){return i.keyOfElement(a)==b});c<0?r(h):q.splice(c,1,a[1])}),q.length?(q.unshift(p,{}),e.cloneElement.apply(null,q)):p}function w(a,b,c,d){if(!d)return c;var e=a[d];if(e)return e;for(var f=d.split("."),g="";f.length;){var h=f.shift();g?g+="."+h:g=h;var j,k=a[g];if(k)c=k;else{if(!Array.isArray(j=c.props.children)||!(k=j.find(function(a){return i.keyOfElement(a)==h})))return r(b+"."+g),null;c=a[g]=k}}return c}var a=i.pageCtrl;if(!(a&&a.keys.length>0)){var b=l.topmostWidget_,c=b&&b.component;if(c){for(var d=null,f=c.$gui.comps||[],g=f.length,h=0;h<g;h++){var j=f[h];if(j&&j.props["isScenePage."]){var k=i.keyOfElement(j),m=k&&b[k];if(m=m&&m.component){if(m.props.noShow){var n=m.elementOf("link_table");if(n)try{d=JSON.parse(n.props["html."]||"{}")}catch(a){console.log("fatal error: parse json of link_table failed")}}break}}}if(d){var o=d.root;if(!Array.isArray(o))return;var p=[];o.forEach(function(a){var b=c.elementOf(a);if(b){var e=d[a];if(e){var f=q(a,b,e,"/"+a+"/",{});f&&p.push(f)}else p.push(b)}else r(a)}),p.length&&c.setChild.apply(c,p)}}}})}});