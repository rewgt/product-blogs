window.W||(window.W=new Array,W.$modules=[]),W.$modules.push(function(t,e,a){function r(t){return t.getBoundingClientRect()}function i(t){var e=document.createElement("a");return e.href=t,""==e.host&&(e.href=e.href),e}function l(t){t.stopPropagation()}function o(t,e){return e?e.querySelector(t):document.querySelector(t)}function n(t,e,a){"string"==typeof t?o(t).addEventListener(e,a,!1):t.addEventListener(e,a,!1)}function s(t){var e=ee[t];e||(e=t);var a=/^#[0-9A-Fa-f]+/.exec(e);if(a){var r=a[0].slice(1);if(3==r.length)return[parseInt("0x"+r[0]+r[0]),parseInt("0x"+r[1]+r[1]),parseInt("0x"+r[2]+r[2])];if(r.length>=6)return[parseInt("0x"+r.slice(0,2)),parseInt("0x"+r.slice(2,4)),parseInt("0x"+r.slice(4,6))]}else if(a=/^(rgb|rgba)\s*\(([^)]*)\)/.exec(e)){for(var i,l=a[2].split(","),o=0;i=l[o];o++)l[o]=o<3?parseInt(i)||0:parseFloat(i);return l}return null}function f(){document.getElementById("color-dlg").style.display="none",te=null,qt.style.display="none",zt.style.display="none"}function d(t){for(var e,a=t?"none":"block",r=t?"block":"none",i=Tt.parentNode,l=0;e=i.children[l];l++)e.style.display=e===Tt?a:r;Rt.style.display=t?"block":"none"}function c(t){if(ae&&Nt){var e=Nt.componentOf(ae+".txt");e&&(e.duals["html."]=Dt.value)}}function h(t,e,a){e=e||0;var r,i,l,o=t[0],n=0;Array.isArray(o)?(n=t.length-1,r=o[0],i=o[1],l=o[2]):(r=o,i=t[1],l=t[2]),"number"!=typeof l&&(l=ie[r]||3);var s=function(){return new Array(e+1).join("  ")}(),f=s;if(!r){var d=i.html||[],c=a<=1?"<div class='rewgt-static'>":"<span class='rewgt-static'>",u=a<=1?"</div>":"</span>";return 0==d.length?f="":1==d.length?f+=c+d[0]+u+"\n":(f+=c+"\n",d.forEach(function(t){f+=s+"  "+t+"\n"}),f+=s+u+"\n"),f}var p=!1;"RefDiv"==r?(!0,p=i["isPre."],n=0,f+=(p?"<pre $=":"<div $=")+JSON.stringify(i.$||"")):"RefSpan"==r?(!0,n=0,f+="<span $="+JSON.stringify(i.$||"")):3==l?f+="<span $="+r:(!(p=i["isPre."])&&le[r]&&(p=!0),p&&(n=0),f+=(p?"<pre $=":"<div $=")+r);var g=i.key,y=i["html."];g&&(f+=" key='"+g+"'");for(var v in i)if("key"!=v&&"html."!=v&&"$"!=v&&"isPre."!=v){var m=i[v];void 0!==m&&("style"==v&&(v="sty__"),f+=" "+v.replace(re,"-$1").toLowerCase()+"=","string"!=typeof m||"$"!=v[0]&&m&&"{"==m[0]&&"}"==m.slice(-1)?f+="'{"+JSON.stringify(m).replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"}'":f+=JSON.stringify(m))}if(n){for(var w,b="",k=1;w=t[k];k+=1)b+=h(w,e+1,l);3==l?b.startsWith(s+"  ")?f+=">"+b.slice(s.length+2):f+=">"+b:f+=">\n"+b}else f+=">",y&&(f+=p?y:y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"));return p?f+="</pre>\n":3==l?f+="</span>\n":y||"\n"!=f.slice(-1)?f+="</div>\n":f+=s+"</div>\n",f}function u(t,e,a,r,i){if(!Array.isArray(r.widget))return!1;var l=h(r.widget,i,1);if(!l)return!1;if(i>0){var o=new Array(i+1).join("  ");l.startsWith(o)&&(l=l.slice(o.length))}if("number"==typeof e){var n=t.value;t.value=n.slice(0,e)+l+n.slice(a),t.selectionEnd=t.selectionStart=e+l.length}else document.selection?(t.focus(),document.selection.createRange().text=l):t.value=t.value+l;return!0}function p(t){var e="";if(st(t.dataTransfer,"application/json")){var a=null,r=t.dataTransfer.getData("application/json")||"{}";try{a=JSON.parse(r)}catch(t){console.log(t)}if(a){var l;if("image"==a.dragType&&(l=a.dragUrl)){"/"!=(g=i("./").pathname)[0]&&(g="/"+g),"/"!=(y=i(l).pathname)[0]&&(y="/"+y),y.startsWith(g)&&(y=y.slice(g.length));var o=y.split("/").pop();e="number"==typeof a.clientWidth?'<img alt="'+o+'" style="width:'+a.clientWidth+"px; height:"+a.clientHeight+'px" src="'+y+'">':"!["+o+"]("+y+")"}else if("template"==a.dragType&&(l=a.dragUrl)){var n=this.selectionStart,s=this.selectionEnd,f=0;if("number"==typeof n){var d=this.value.slice(0,n).split("\n").pop();d.trim()||(f=Math.floor(d.length/2))}var h=this,p=a.option;return p?p.name&&u(h,n,s,p,f)&&c():dt(l+=".json",function(t,e){if(t)rootNode.instantShow("error: read JSON failed ("+l+")."),console.log(t);else{try{p=JSON.parse(e)}catch(t){console.log("error: parse JSON failed ("+l+").")}p&&p.name&&u(h,n,s,p,f)&&c()}}),t.preventDefault(),void t.stopPropagation()}}}else if(st(t.dataTransfer,"text/uri-list")&&(l=t.dataTransfer.getData("text/uri-list")||"")){var g=i("./").pathname;"/"!=g[0]&&(g="/"+g);var y=i(l).pathname;"/"!=y[0]&&(y="/"+y),y.startsWith(g)&&(y=y.slice(g.length)),e="["+y.split("/").pop()+"]("+y+")"}if(e){if(t.preventDefault(),t.stopPropagation(),"number"==typeof(n=this.selectionStart)){var v=this.value;this.value=v.slice(0,n)+e+v.slice(this.selectionEnd),this.selectionEnd=this.selectionStart=n+e.length}else document.selection?(this.focus(),document.selection.createRange().text=e):this.value=this.value+e;c()}}function g(){Bt.innerHTML="",Bt.style.display="none",Vt.style.display="none",Ut.style.display="none",oe="",d(!1),Ft.focus(),setTimeout(function(){ae="",Dt.value=""},0)}function y(t,e){var a=o("div.link",t),r=o("div.clone",t),i=o("div.fork",t),l=o("div.rotate",t),n=o("div.klass",t);"widget"==e?(a.style.display="block",r.style.display="block",i.style.display="block",l.style.display="block",n.style.display="block"):(i.style.display="none",l.style.display="none",n.style.display="none","arrow"==e?(a.style.display="block",r.style.display="none"):"auto-arrow"==e?(a.style.display="none",r.style.display="none"):"iso-arrow"==e&&(a.style.display="block",r.style.display="block"))}function v(t,e,a,r,i,l){for(var o=e.length,n=1,s=1,f=1;f<o;f+=2){var d=e[f-1],c=e[f];d>n&&(n=d),c>s&&(s=c)}var h=i/n,u=l/s;t.rateX=h,t.rateY=u;for(var p="",g=1,f=3;f<o;f+=2)p+='<div class="pointer" _pos="'+g+'" style="left:'+(d=e[f-1]*h+a)+"px; top:"+(c=e[f]*u+r)+'px"></div>',g+=1;return p}function m(t,e,a){var i;if(t&&e&&Array.isArray(i=t.state["svg.cfg"])){var l=t.state.stroke||3,o=((t.state.style.strokeColor||"rgb(119,119,119)").trim(),100),n=s((t.state.style.fillColor||"rgb(119,119,119)").trim());n&&n.length>=4&&(o=Math.floor(100*n[3]));var f=i[0]||0,c=i[1]||[],h=0,u=0,p="",g=c.slice(4);c.length>=1&&(p=c[0]),c.length>=3&&(h=c[2]),c.length>=4&&(u=c[3]);var m=!1;if(f>=0){var w=t.componentOf("txt");w&&(m=!0,Dt.value=w.state["html."]||"",ae=a)}var b="visible";m||(b="hidden",setTimeout(function(){Dt.value="",ae=""},0)),Jt.style.visibility=b,Wt.style.visibility=b,Yt.value=o+"",Et.value=l+"";x='<svg width="60" height="14"><line stroke="#ff7f00" stroke-width="1" ';p&&(x+='stroke-dasharray="'+p+'" '),x+='x1="0%" y1="60%" x2="100%" y2="60%"/></svg>',Pt.innerHTML=x;var k=t.state["data-from"];if(f<0&&!k){h<1&&(h=1);x='<svg width="18" height="18" viewBox="0 0 100 100"><path stroke="#ff7f00" fill="#ff7f00" stroke-width="10" d="';x+=(A=He[h-1])+'"/></svg>',Ht.innerHTML=x,Ht.style.visibility="visible"}else Ht.style.visibility="hidden";if(u>=1&&u<=6){var A=Ee[u-1],x='<svg width="18" height="18" viewBox="0 0 100 100"><path stroke="#ff7f00" fill="#ff7f00" stroke-width="10" d="';x+=A+'"/></svg>',Kt.innerHTML=x,Kt.style.visibility="visible"}else Kt.style.visibility="hidden";b=f<0?"hidden":"visible",_t.style.visibility=b,Lt.style.visibility=b,$t.style.visibility=b;var M=r(e);if(f<0){var C=Math.floor(2.5*l+.5);C*=Mt,Bt.innerHTML=v(Bt,g,M.left+C,M.top-Gt+C,M.width-C-C,M.height-C-C),Bt.style.display="block",Bt.classList.remove("no-move")}else Bt.style.display="none";if(k&&f<0){Vt.style.display="none";var N=!e.getAttribute("data-align");Ut.style.display="block",N?y(Ut,"auto-arrow"):y(Ut,"arrow"),Ut.style.left=M.left+"px",Ut.style.top=M.top+"px",Ut.style.width=M.width+"px",Ut.style.height=M.height+"px",N&&Bt.classList.add("no-move")}else{var O=t.state.rotate||0;0==O?(Vt.style.left=M.left-2+"px",Vt.style.top=M.top-2+"px",Vt.style.width=M.width+4+"px",Vt.style.height=M.height+4+"px",Vt.style[xt]="",Vt.style.display="block"):(Vt.style[xt]="rotate("+O+"deg)",Vt.style.display="none"),Ut.style.display="block",f<0?y(Ut,"iso-arrow"):e.getAttribute("data-zero")?y(Ut,"iso-arrow"):y(Ut,"widget"),Ut.style.left=M.left+"px",Ut.style.top=M.top+"px",Ut.style.width=M.width+"px",Ut.style.height=M.height+"px"}}d(!!e)}function w(t){var e=null,a=null;Nt&&t&&(e=Nt.componentOf(t))&&(a=e.getHtmlNode()),m(e,a,t)}function b(t,e,a){function r(){var e=t.state["data-from"];if(e){var a=Nt.componentOf(e);if(!a)return;o=a.state["svg.cfg"];if(Array.isArray(o)&&Array.isArray(l=o[1])){n=l[1];if(Array.isArray(n)){var r=null;n.forEach(function(t){var e=t[0],a=t[2];if(e===i&&a&&e!=a){var l=Nt.componentOf(a);l&&(r=l)}}),r&&(g(),setTimeout(function(){Y(a,r)},100))}}}else{bt.eachComponent(Nt,function(e){if(e!==t){var a,r=e.state["svg.cfg"];if(Array.isArray(r)&&Array.isArray(a=r[1])){var l=a[1];if(Array.isArray(l))for(var o,n=0;o=l[n];n++)o[2]===i&&Y(e,t)}}});t.state.left,t.state.top;var l,o=t.state["svg.cfg"];if(Array.isArray(o)&&Array.isArray(l=o[1])){var n=l[1];Array.isArray(n)&&n.forEach(function(e){var a=e[2];if(a){var r=Nt.componentOf(a);r&&Y(t,r)}})}}}var i="";t?(t.state.left,t.state.top,i=t.duals.keyid+"",setTimeout(function(){m(t,t.getHtmlNode(),i),a&&setTimeout(r,100)},e)):m(null,null,i)}function k(t){gt(!0,!t,!1)}function A(t){if(Nt){for(var e=t.target,a=document.body,r=null;e&&e!==a;){if(e.classList.contains("popline-expand")){r=e;break}e=e.parentNode}r&&(Jt.clientHeight<100?(Rt.style.height="270px",Jt.style.height="270px",r.style[xt]="rotate(90deg)"):(Rt.style.height=Gt+"px",Jt.style.height=Gt+"px",r.style[xt]="rotate(270deg)"))}}function x(t){Nt&&(Nt.duals.offsetX=0,Nt.duals.offsetY=0,St.innerHTML="(0,0)")}function M(t){if(Nt){var e=t.target.checked,a=Nt.state.offsetX,r=Nt.state.offsetY;Nt.duals.style={backgroundRepeat:e?"repeat":"no-repeat",backgroundPosition:a%20+"px "+r%20+"px"}}}function C(t){for(var e=document.body;t&&t!==e&&"DIV"!=t.nodeName;)t=t.parentNode;if(t&&t.parentNode===jt){var a="rgba(0,0,0,0)";return t.querySelector("svg")||(a=window.getComputedStyle(t).backgroundColor),a}return""}function N(t,e){if(Nt&&oe){var a=C(t);if(a){if(!e){document.querySelector("#group-opacity");Yt.value="rgba(0,0,0,0)"==a?"0":"100"}var r={};e?(r.strokeColor=a,ne=a):(r.fillColor=a,se=a);var i=Nt.componentOf(oe);i&&(i.duals.style=r)}}}function O(t){for(;t&&"DIV"!=t.nodeName;)t=t.parentNode;t&&t.parentNode===jt&&(t.querySelector("svg")||(document.querySelector("#color-dlg").style.display="block",te=t))}function T(t){if(!(t.ctrlKey||t.altKey||t.metaKey)){var e=t.target,a=t.shiftKey,r=!1;t.timeStamp-he<300?(r=!0,ue=he=t.timeStamp,O(e)):(setTimeout(function(){if(!r&&ue!=he){var i=null;if("none"!=Rt.style.display){var l,o=Dt.selectionStart;if("number"==typeof o&&o!=(l=Dt.selectionEnd)){var n=Dt.value;i=[n.slice(0,o),n.slice(o,l),n.slice(l)]}}var s,d;if(i&&(s=i[1])&&(d=C(e))){t.stopPropagation();var h=/^#[0-9A-Fa-f]+$/,u=/^(rgb|rgba)\([ ,0-9]+\)$/;d=d.replace(/ /g,""),0==s.search(h)||0==s.search(u)?Dt.value=i[0]+d+i[2]:Dt.value=i[0]+'<span style="color:'+d+'">'+s+"</span>"+i[2],c()}else f(),N(e,a)}},300),he=t.timeStamp)}}function I(t){var e=t.target;if(te&&"TD"==e.nodeName){var a=e.getAttribute("bgcolor")||"#FFFFFF";te.style.backgroundColor=a}f(),t.stopPropagation()}function X(t,e,a,r){var i=a-t,l=r-e,o=Math.abs(i),n=Math.abs(l);if(0==o&&0==n)return 0;var s=Math.sqrt(o*o+n*n),f=Math.acos(n/s),d=180/(Math.PI/f);return i>0?l>0?90-d:270+d:l>0?90+d:270-d}function S(t,e,a,r){document.querySelector("div.free-transform");Vt.style.left=t-2+"px",Vt.style.top=e-2+"px",Vt.style.width=a+4+"px",Vt.style.height=r+4+"px",Ut.style.left=t+"px",Ut.style.top=e+"px",Ut.style.width=a+"px",Ut.style.height=r+"px"}function Y(t,e,a){function i(t,e,a){return t>=a.left&&t<a.left+a.width&&e>=a.top&&e<a.top+a.height}var l=t.state["svg.cfg"];if(Array.isArray(l)&&Array.isArray(ht=l[1])){var o=t.getHtmlNode(),n=e.getHtmlNode();if(o&&n){var s=t.duals.keyid+"",f=ht[1];Array.isArray(f)||(ht[1]=f=[]);var d=e.duals.keyid+"",c=r(o),h=r(n),u=!1;(i(c.left,c.top,h)||i(c.left+c.width-1,c.top,h)||i(c.left+c.width-1,c.top+c.height-1,h)||i(c.left,c.top+c.height-1,h))&&(u=!0);for(var p,g="",y="",v=ne,m=se,w=de,b=fe,k=ce,A=0;p=f[A];A++){var x=p[2];if(x&&x===d){var M=p[0],C=Nt.componentOf(M);if(C){var N=C.state["svg.cfg"];if(Array.isArray(N)){w=C.state.stroke||3,v=C.state.style.strokeColor||"rgb(119,119,119)",m=C.state.style.fillColor||"rgb(119,119,119)";var O=N[1];Array.isArray(O)&&(b=O[0]||"",k=O[3],isNaN(k)&&(k=2))}if(u)3==p.length&&p.push([v,m,w,b,k]);else{var T=p[3];Array.isArray(T)&&(p.splice(3,1),v=T[0],m=T[1],w=T[2],b=T[3],k=T[4])}y="-"+M}void 0===a&&(a=-2==p[1]),g=p[0];break}}if(u)y&&Nt.setChild(y);else{g||(g="auto"+(Zt+=1),f.push([g,a?-2:-1,d]));c.width,c.height;var I=c.left+c.width/2,S=c.top+c.height/2,Y=X(I,S,c.left+c.width,c.top+c.height),E=X(I,S,c.left,c.top+c.height),H=X(I,S,c.left,c.top),K=X(I,S,c.left+c.width,c.top),P=(h.width,h.height,h.left+h.width/2),_=h.top+h.height/2,L=(X(P,_,h.left+h.width,h.top+h.height),X(P,_,h.left,h.top+h.height),X(P,_,h.left,h.top),X(P,_,h.left+h.width,h.top),Math.floor(2.5*w+.5)),$=L;L*=Mt;var q,z,j,J,W,D,R=0,F=0,B=-$,U=-$,V=t.props["data-zero"],G=e.props["data-zero"];if(V){q=I,z=S;var Z=c.width>=c.height,Q=!1,tt=!1,et=!1;P>=I?G?(W=P,D=_,Math.abs(D-z)<=L&&(Q=!0,et=!0),W-q<=L&&(Q=!0,tt=!0)):q>=h.left?(W=q,D=_<S?h.top+h.height:h.top,Q=!0):Z?z>=h.top&&z<h.top+h.height?(W=h.left,D=z,Q=!0):(W=P,D=_<S?h.top+h.height:h.top,W-q<10&&(W=Math.min(h.left+h.width,q+20)),Math.abs(D-z)<=L&&(W=h.left,Q=!0,et=!0)):z>=h.top&&z<h.top+h.height?(W=h.left,D=z,Q=!0):(W=h.left,D=_,_<S?z-D<10&&(D=Math.max(h.top,z-20)):D-z<10&&(D=Math.min(h.top+h.height,z+20)),Math.abs(W-q)<=L&&(D=_<S?h.top+h.height:h.top,Q=!0,tt=!0)):G?(W=P,D=_,Math.abs(D-z)<=L&&(Q=!0,et=!0),q-W<=L&&(Q=!0,tt=!0)):q<h.left+h.width?(W=q,D=_<S?h.top+h.height:h.top,Q=!0):Z?z>=h.top&&z<h.top+h.height?(W=h.left+h.width,D=z,Q=!0):(W=P,D=_<S?h.top+h.height:h.top,q-W<10&&(W=Math.max(h.left,q-20)),Math.abs(D-z)<=L&&(W=h.left+h.width,Q=!0,et=!0)):z>=h.top&&z<h.top+h.height?(W=h.left+h.width,D=z,Q=!0):(W=h.left+h.width,D=_,_<S?z-D<10&&(D=Math.max(h.top,z-20)):D-z<10&&(D=Math.min(h.top+h.height,z+20)),Math.abs(W-q)<=L&&(D=_<S?h.top+h.height:h.top,Q=!0,tt=!0)),Q?(j=(q+W)/2,J=(z+D)/2):a?Z?(j=q+3*(W-q)/5,J=z+(D-z)/5):(j=q+(W-q)/5,J=z+3*(D-z)/5):Z?(j=W,J=z):(j=q,J=D),Q?(tt&&(B=0),et&&(U=0),D<z&&!et&&(F=$),W<q&&!tt&&(R=$)):Z?(B=0,D<z&&(F=$)):(U=0,W<q&&(R=$))}else{var at=X(I,S,P,_);at>K&&at<=360||at>=0&&at<=Y?_>=c.top&&_<c.top+c.height?(z=_,D=_,j=((q=c.left+c.width)+(W=G?P:h.left))/2,J=_):(U=0,W=G?P:h.left,D=_,at>K&&at<=360?(q=I,z=c.top,!G&&z-D<10&&(D=Math.max(h.top,z-20))):(q=I,z=c.top+c.height,!G&&D-z<10&&(D=Math.min(h.top+h.height,z+20))),a?(j=q+(W-q)/5,J=z+3*(D-z)/5):(j=q,J=D)):at>Y&&at<=E?P>=c.left&&P<c.left+c.width?(q=P,W=P,j=P,J=((z=c.top+c.height)+(D=G?_:h.top))/2):(B=0,W=P,D=G?_:h.top,at<=90?(q=c.left+c.width,z=S,!G&&W-q<10&&(W=Math.min(h.left+h.width,q+20))):(q=c.left,z=S,!G&&q-W<10&&(W=Math.max(h.left,q-20))),a?(j=q+3*(W-q)/5,J=z+(D-z)/5):(j=W,J=z)):at>E&&at<=H?_>=c.top&&_<c.top+c.height?(z=_,D=_,j=((q=c.left)+(W=G?P:h.left+h.width))/2,J=_,R=$):(U=0,W=G?P:h.left+h.width,D=_,at<=180?(q=I,z=c.top+c.height,!G&&D-z<10&&(D=Math.min(h.top+h.height,z+20)),R=$):(q=I,z=c.top,!G&&z-D<10&&(D=Math.max(h.top,z-20)),R=$),a?(j=q+(W-q)/5,J=z+3*(D-z)/5):(j=q,J=D)):P>=c.left&&P<c.left+c.width?(q=P,W=P,j=P,J=((z=c.top)+(D=G?_:h.top+h.height))/2,B=0,F=$):(B=0,W=P,D=G?_:h.top+h.height,at<=270?(q=c.left,z=S,!G&&q-W<10&&(W=Math.max(h.left,q-20)),F=$):(q=c.left+c.width,z=S,!G&&W-q<10&&(W=Math.min(h.left+h.width,q+20)),F=$),a?(j=q+3*(W-q)/5,J=z+(D-z)/5):(j=W,J=z))}q=Math.floor(q+.5),z=Math.floor(z+.5),j=Math.floor(j+.5),J=Math.floor(J+.5),W=Math.floor(W+.5),D=Math.floor(D+.5);var rt=Math.min(q,W),it=Math.min(z,D),lt=rt-L+R,ot=it-L+F-Gt,nt=L+L+1,st=Math.max(Math.abs(W-q)+L+L+B,nt),ft=Math.max(Math.abs(D-z)+L+L+U,nt),dt=Nt.state.offsetX||0,ct=Nt.state.offsetY||0,ht=[b,0,0,k,q-rt,z-it,j-rt,J-it,W-rt,D-it],ut=[a?-2:-1,ht,Ct],pt=bt.loadElement(["rewgt.SvgPanel",{key:g,klass:"nowrap-default-wrap_reverse items_center-end-stretch-default",left:lt-dt,top:ot-ct,width:st,height:ft,style:{strokeColor:v,fillColor:m,zIndex:"-1"},stroke:w,"svg.cfg":ut,"data-from":s}]);y?Nt.setChild(y,function(t){Nt.setChild(pt)}):Nt.setChild(pt)}}}}function E(t){function e(t,e){var i=null,l=-999;return bt.eachComponent(Nt,function(o){var n=o.getHtmlNode();if(n){var s=r(n);if(t>=s.left&&t<s.left+s.width&&e>=s.top&&e<s.top+s.height){if(o.state["data-from"])return void(a=!0);var f=parseInt(n.style.zIndex||"0");(!i||f>=l)&&(l=f,i=o)}}}),i}var a=!1;if(Nt&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)){t.stopPropagation();var i=!1;oe||((c=e(t.clientX,t.clientY))&&(b(c,0,!1),oe=c.duals.keyid+""),i=!0);var l,o=null;if(oe&&(l=Nt.componentOf(oe))){var n=l.getHtmlNode();if(l.state["data-from"])a=!0;else if(n){var s=r(n),f=t.clientX,d=t.clientY;f>=s.left&&f<s.left+s.width&&d>=s.top&&d<s.top+s.height&&(o=l)}}if(oe&&!o&&!i){var c=e(t.clientX,t.clientY);c&&(b(c,0,!1),oe=c.duals.keyid+"",o=c)}o&&(Ae=o,xe=!1,Me=[],Ce=[],Ne=f,Oe=d,Te=o.state.left,Ie=o.state.top,setTimeout(function(){Ut.style.display="none",Bt.style.display="none",Vt.style.display="none"},0)),o||oe||a||(pe=Ft,ge=!1,me=ye=t.clientX,we=ve=t.clientY,be=Nt.state.offsetX,ke=Nt.state.offsetY,Nt.duals.style={cursor:"pointer"})}}function H(t){var e="-"+t.duals.keyid;setTimeout(function(){Nt.setChild(e)},100)}function K(t,e,a,r,i,l,o){t.duals.left=r,t.duals.top=i,t.reRender(function(){e.forEach(function(e){Y(e,t)}),a.forEach(function(e){var a=e[0];3==e.length?(a.duals.left=e[1]+l,a.duals.top=e[2]+o):Y(t,a)})})}function P(t){function e(t,e,a){"none"!=t.style.display&&(t.style.left=parseFloat(t.style.left)+e+"px",t.style.top=parseFloat(t.style.top)+a+"px")}if(Nt){var a=t.clientX,i=t.clientY;if(Ae){var l=a-Ne,o=i-Oe;if(!xe&&(Math.abs(l)>5||Math.abs(o)>5)){xe=!0;var n=Ae.duals.keyid+"";bt.eachComponent(Nt,function(t){if(t!==Ae){var e,a=t.state["svg.cfg"];if(Array.isArray(a)&&Array.isArray(e=a[1])){var r=e[1];if(Array.isArray(r))for(var i,l=0;i=r[l];l++)i[2]===n&&Me.push(t)}}});var s=Ae.state["svg.cfg"];if(Array.isArray(s)&&Array.isArray(W=s[1])){var f=W[1];Array.isArray(f)&&f.forEach(function(t){var e=t[0],a=t[2];if(a)(r=Nt.componentOf(a))&&Ce.push([r]);else{var r=Nt.componentOf(e);r&&Ce.push([r,r.state.left,r.state.top])}})}}xe&&K(Ae,Me,Ce,Te+l,Ie+o,l,o)}else if(pe){var l=a-ye,o=i-ve;if(ge||(Math.abs(l)>5||Math.abs(o)>5)&&(ge=!0),ge){var d=be+l,c=ke+o;Nt.duals.offsetX=d,Nt.duals.offsetY=c,Nt.duals.style={backgroundPosition:d%20+"px "+c%20+"px"},St.innerHTML="("+d+","+c+")";var h=a-me,u=i-we;me=a,we=i,e(Bt,h,u),e(Vt,h,u),e(Ut,h,u)}}else if(_e){var l=a-Le,o=i-$e;_e.duals.left=qe+l,_e.duals.top=ze+o}else if(ra){var l=a-oa,o=i-na;ia.duals.left=sa+l,ia.duals.top=fa+o}else if(je){if(B=je.getHtmlNode()){T=X((et=r(B)).left+et.width/2,et.top+et.height/2,a,i);(I=(Je+T-We)%360)<0&&(I+=360),je.duals.rotate=I,Vt.style[xt]=0==I?"":"rotate("+I+"deg)"}}else if(De){var l=a-Fe,o=i-Be,p=Ue.left-(Nt.state.offsetX||0),g=Ue.top-Gt-(Nt.state.offsetY||0);if("top-left"==Re){var y=Ue.width-l,v=Ue.height-o;y>=12&&v>=12&&(De.duals.left=p+l,De.duals.top=g+o,De.duals.width=y,De.duals.height=v,S(Ue.left+l,Ue.top+o,y,v))}else if("top"==Re)(v=Ue.height-o)>=12&&(De.duals.top=g+o,De.duals.height=v,S(Ue.left,Ue.top+o,Ue.width,v));else if("top-right"==Re){var y=Ue.width+l,v=Ue.height-o;y>=12&&v>=12&&(De.duals.top=g+o,De.duals.width=y,De.duals.height=v,S(Ue.left,Ue.top+o,y,v))}else if("right"==Re)(y=Ue.width+l)>=12&&(De.duals.width=y,S(Ue.left,Ue.top,y,Ue.height));else if("bottom-right"==Re){var y=Ue.width+l,v=Ue.height+o;y>=12&&v>=12&&(De.duals.width=y,De.duals.height=v,S(Ue.left,Ue.top,y,v))}else if("bottom"==Re)(v=Ue.height+o)>=12&&(De.duals.height=v,S(Ue.left,Ue.top,Ue.width,v));else if("bottom-left"==Re){var y=Ue.width-l,v=Ue.height+o;y>=12&&v>=12&&(De.duals.left=p+l,De.duals.width=y,De.duals.height=v,S(Ue.left+l,Ue.top,y,v))}else"left"==Re&&(y=Ue.width-l)>=12&&(De.duals.left=p+l,De.duals.width=y,S(Ue.left+l,Ue.top,y,Ue.height))}else if(Ve){if(!(B=Ve.getHtmlNode()))return;var m,w,b="";if(Ze)m=Qe,w=ta;else{if(a>=(et=r(B)).left&&a<=et.left+et.width&&i>=et.top&&i<=et.top+et.height)return;if(Math.abs(a-ea)<20&&Math.abs(i-aa)<20)return;var k,A,x=Ve.state["data-zero"],M=et.left+et.width/2,C=et.top+et.height/2,N=et.width/2,O=et.height/2;if(x)b="center,0",k=M,A=C,m=Math.floor(k+.5),w=Math.floor(A+.5);else{var T=X(M,C,et.left+et.width,et.top+et.height),I=X(M,C,et.left,et.top+et.height),Y=X(M,C,et.left,et.top),E=X(M,C,et.left+et.width,et.top),P=X(M,C,a,i);P>E&&P<=360||P>=0&&P<=T?(b="right",k=M+N,A=i>et.top+2&&i<et.top+et.height-2?i:C+N*(i-C)/(a-M)):P>T&&P<=I?(b="bottom",A=C+O,k=a>et.left+2&&a<et.left+et.width-2?a:M+O*(a-M)/(i-C)):P>I&&P<=Y?(b="left",k=et.left,A=i>et.top+2&&i<et.top+et.height-2?t.clientY:C+N*(i-C)/(M-a)):(b="top",A=et.top,k=a>et.left+2&&a<et.left+et.width-2?a:M+O*(a-M)/(C-i)),m=Math.floor(k+.5),w=Math.floor(A+.5),b+="right"==b||"left"==b?","+(w-Gt):","+m}}var L=Math.floor(2.5*de+.5);L*=Mt;var $=Math.min(a,m),q=Math.min(i,w),d=$-L,c=q-L-Gt,z=L+L+1,j=Math.max(Math.abs(a-m)+L+L,z),J=Math.max(Math.abs(i-w)+L+L,z),W=[fe,0,0,ce,m-$,w-q,a-$,i-q],D=[Ge?-2:-1,W,Ct];if(Xe&&(Se===Ve?(Xe.duals.left=d-(Nt.state.offsetX||0),Xe.duals.top=c-(Nt.state.offsetY||0),Xe.duals.width=j,Xe.duals.height=J,Xe.duals["data-align"]=b,Xe.duals["svg.cfg"]=D):(H(Xe),Xe=null,Se=null)),!Xe){var R="auto"+(Zt+=1),F=bt.loadElement(["rewgt.SvgPanel",{key:R,klass:"nowrap-default-wrap_reverse items_center-end-stretch-default",left:d-(Nt.state.offsetX||0),top:c-(Nt.state.offsetY||0),width:j,height:J,style:{strokeColor:ne,fillColor:se,zIndex:"-1"},stroke:de,"svg.cfg":D,"data-align":b,"data-from":""}]);Nt.setChild(F,function(t){var e=Nt.componentOf(R);e&&(Xe=e,Se=Ve)})}}else if(da){var B=da.getHtmlNode();if(B&&ca&&"block"==Bt.style.display){var U=da.state["svg.cfg"];if(Array.isArray(U)&&Array.isArray(subCfg=U[1])){var l=a-pa,o=i-ga,V=parseInt(ca.getAttribute("_pos")||"1"),G=V+V+5;if(G<subCfg.length){(U=U.slice(0))[1]=subCfg=subCfg.slice(0);var Z=da.state.stroke,Q=Bt.rateX||1,tt=Bt.rateY||1,et=r(B);subCfg[G-1]=ha+l/Q,subCfg[G]=ua+o/tt;var at=_(et,subCfg,Z,Q,tt);da.duals.left=at[0],da.duals.top=at[1],da.duals.width=at[2],da.duals.height=at[3],da.duals["svg.cfg"]=U,ca.style.left=ya+l+"px",ca.style.top=va+o+"px"}}}}}}function _(t,e,a,r,i){var l=Math.floor(2.5*a+.5);l*=Mt;for(var o=65535,n=65535,s=0,f=0,d=e.length,c=5;c<d;c+=2){var h=e[c-1],u=e[c];h<o&&(o=h),u<n&&(n=u)}for(c=5;c<d;c+=2){var h=e[c-1]-o,u=e[c]-n;e[c-1]=h,e[c]=u,h>s&&(s=h),u>f&&(f=u)}ha-=o,ua-=n;var p=l+l+1;return[Math.floor(t.left+o*r+.5)-(Nt.state.offsetX||0),Math.floor(t.top+n*i+.5)-Gt-(Nt.state.offsetY||0),Math.floor(Math.max(s*r+l+l,p)+.5),Math.floor(Math.max(f*i+l+l,p)+.5)]}function L(t){function e(t,e){var a=t-e,r=4*Math.floor(a/4),i=a-r;return i>2?r+=4:i<-2&&(r-=4),r+e}function a(t){var e=4*Math.floor(t/4);return t-e>2?e+4:e}if(Nt){t.stopPropagation();var i=!0;if(Ae){if(xe){i=!1;var l=Nt.state.offsetX||0,o=Nt.state.offsetY||0,n=e(t.clientX,l)-Ne,s=e(t.clientY,o)-Oe;K(Ae,Me,Ce,Te+n,Ie+s,n,s),b(Ae,100,!1)}xe=!1,Me=[],Ce=[]}else if(pe)ge&&(i=!1),Nt.duals.style={cursor:""},ge=!1;else if(_e)i=!1,setTimeout(function(t){t.duals.left=e(t.state.left,0),t.duals.top=e(t.state.top,0)},0,_e);else if(ra)i=!1,setTimeout(function(t,a){a.duals.left=e(a.state.left,0),a.duals.top=e(a.state.top,0),a.reRender(function(){Y(t,a,la)})},0,ra,ia),ia=null;else if(je){if(i=!1,v=je.getHtmlNode()){var d=je.state.rotate||0;if(0!=d){var c=15*Math.floor(d/15);d!=c&&(d=d-c<7.5?c:(c+15)%360)}je.duals.rotate=d,Vt.style[xt]=0==d?"":"rotate("+d+"deg)"}b(je,100,!0)}else if(De){i=!1;v=De.getHtmlNode();if(m=v&&r(v)){var h=m.left,u=m.top-Gt,p=m.width,y=m.height;"top-left"==Re?(De.duals.left=e(h-(Nt.state.offsetX||0),0),De.duals.top=e(u-(Nt.state.offsetY||0),0),De.duals.width=a(p),De.duals.height=a(y)):"top"==Re?(De.duals.top=e(u-(Nt.state.offsetY||0),0),De.duals.height=a(y)):"top-right"==Re?(De.duals.top=e(u-(Nt.state.offsetY||0),0),De.duals.width=a(p),De.duals.height=a(y)):"right"==Re?De.duals.width=a(p):"bottom-right"==Re?(De.duals.width=a(p),De.duals.height=a(y)):"bottom"==Re?De.duals.height=a(y):"bottom-left"==Re?(De.duals.left=e(h-(Nt.state.offsetX||0),0),De.duals.width=a(p),De.duals.height=a(y)):"left"==Re&&(De.duals.left=e(h-(Nt.state.offsetX||0),0),De.duals.width=a(p))}b(De,100,!0)}else if(Ve){if(i=!1,Ze){var v=Ve.getHtmlNode(),n=t.clientX-Qe,s=t.clientY-ta;if(v&&(Math.abs(n)>=4||Math.abs(s)>=4)){var m=r(v);setTimeout(function(t,e,a){var r,i=t.state["svg.cfg"],l=t.state.stroke;if(Array.isArray(i)&&Array.isArray(r=i[1])){i=i.slice(0),r=r.slice(0),i[1]=r;var o=r[r.length-2],f=r[r.length-1];r.push(o+n/e,f+s/a);var d=_(m,r,l,e,a);t.duals.left=d[0],t.duals.top=d[1],t.duals.width=d[2],t.duals.height=d[3],t.duals["svg.cfg"]=i,b(t,100,!1)}},100,Ve,Bt.rateX,Bt.rateY)}}else if(Xe){var k=t.clientX,A=t.clientY,x=null,M=-999;bt.eachComponent(Nt,function(t){if(t!==Ve){var e=t.state["data-align"],a=t.getHtmlNode();if(!e&&a){var i=r(a),l=i.width/10,o=i.height/10;if(k>=i.left+l&&k<i.left+i.width-l&&A>=i.top+o&&A<i.top+i.height-o){var n=parseInt(a.style.zIndex||"0");n>=M&&(x=t,M=n)}}}}),x?Y(Ve,x,Ge):(setTimeout(function(t,e){e.duals["data-from"]=t.duals.keyid+"";var a=t.state["svg.cfg"];if(Array.isArray(a)&&a.length>=2){var r=e.duals.keyid+"",i=a[1],l=i[1];Array.isArray(l)||(i[1]=l=[]),l.push([r,Ge?-2:-1])}},100,Ve,Xe),Xe=null,Se=null)}Xe&&(H(Xe),Xe=null,Se=null)}else da&&(i=!1,b(da,100,!0),ca=null);var C=null;if(i){var N=t.target;if(N===Rt)!0;else{for(var O=document.body,T=!1,I=null;N&&N!==O;){if(N===Ft){T=!0;break}N.classList.contains("rewgt-paperview")&&(C=I),I=N,N=N.parentNode}T||(i=!1,C=null)}}i&&(f(),C&&(oe=bt.keyOfNode(C))?w(oe):g()),pe=null,Ae=null,_e=null,ra=null,je=null,De=null,Ve=null,da=null}}function $(t){if(Nt&&!(t.ctrlKey||t.altKey||t.metaKey)){var e=t.shiftKey,a=e&&38==t.keyCode,i=e&&40==t.keyCode;if(a||i){var l=[];if(bt.eachComponent(Nt,function(t){var e=t.getHtmlNode();if(e){var a=r(e);l.push([a.top,a.left,t,t.duals.keyid+""])}}),l.length){l.sort(function(t,e){var a=t[0],r=e[0];return a==r?t[1]>e[1]?1:-1:a>r?1:-1});var o=0;if(oe){var n=l.findIndex(function(t){return t[3]===oe});n>=0&&(a?o=n>0?n-1:l.length-1:(o=n+1)==l.length&&(o=0))}var s=l[o];g(),setTimeout(function(){oe=s[3],b(s[2],100,!1)},100)}}}}function q(t){var e,a,i=t.target,l=r(i),o=l.height/2,n=t.clientX-l.left,s=t.clientY-l.top;l.width-n<18?(e=s>o?"100% -36px":"100% -18px",a="default"):(e="100% 0px",a="auto"),i.style.backgroundPosition=e,i.style.cursor=a}function z(t){t.target.style.backgroundPosition="100% 0px"}function j(t,e,a){var r=t.componentOf(e);if(r){var i,l=s((r.state.style.fillColor||"").trim());l&&l.length>=3&&(i=100==a?"rgb("+l[0]+","+l[1]+","+l[2]+")":"rgba("+l[0]+","+l[1]+","+l[2]+","+(a/100).toPrecision(2)+")",r.duals.style={fillColor:i})}}function J(t){if(Nt&&oe){var e=t.target,a=r(e),i=a.height/2,l=t.clientX-a.left,o=t.clientY-a.top;if(a.width-l<18){var n=parseInt(e.value)||0,s=5*Math.floor(n/5);o>i?(n!=s?n=s:n-=5,n<0&&(n=0)):(n!=s?n=s+5:n+=5,n>100&&(n=100)),e.value=n+"",j(Nt,oe,n)}}}function W(t){if(Nt&&oe){var e=t.target,a=parseInt(e.value)||0;(a=Math.max(0,Math.min(100,a)))+""!==e.value&&setTimeout(function(){e.value=a+""},0),j(Nt,oe,a)}}function D(t,e,a){var r=t.componentOf(e);r&&(r.duals.stroke=de=a||3,b(r,100,!0))}function R(t){if(Nt&&oe){var e=t.target,a=r(e),i=a.height/2,l=t.clientX-a.left,o=t.clientY-a.top;if(a.width-l<18){var n=parseInt(e.value);o>i?n>=2&&(n-=1):n<360&&(n+=1),e.value=n+"",D(Nt,oe,n)}}}function F(t){if(Nt&&oe){var e=t.target,a=parseInt(e.value)||3;(a=Math.max(1,Math.min(360,a)))+""!==e.value&&setTimeout(function(){e.value=a+""},0),D(Nt,oe,a)}}function B(t,e){Nt&&oe&&setTimeout(function(){Ye=e,zt.style.display="block"},10)}function U(t){if(Nt&&oe){for(var e=t.target;e&&"svg"!=e.nodeName;)e=e.parentNode;if(e){var a,r=parseInt(e.getAttribute("_style")||"1"),i=Nt.componentOf(oe);if(i&&Array.isArray(a=i.state["svg.cfg"])){var l=(a[1]||[]).slice(0);0==l.length&&l.push(""),1==l.length&&l.push(0),2==l.length&&l.push(1);var o='<svg width="18" height="18" viewBox="0 0 100 100"><path stroke="#ff7f00" fill="#ff7f00" stroke-width="10" d="';o+=(Ye?He[r]||He[0]:Ee[r]||Ee[1])+'"/></svg>';var n,s=3;Ye?(s=2,n=Ht):(n=Kt,ce=r+1),n.innerHTML=o,l[s]=Ye&&0==r?0:r+1,(a=a.slice(0))[1]=l,i.duals["svg.cfg"]=a}}}}function V(t){Nt&&oe&&setTimeout(function(){qt.style.display="block"},10)}function G(t){if(Nt&&oe){for(var e=t.target;e&&"svg"!=e.nodeName;)e=e.parentNode;if(e){var a,r=Nt.componentOf(oe);if(r&&Array.isArray(a=r.state["svg.cfg"])){var i=(a[1]||[]).slice(0),l=parseInt(e.getAttribute("_style")||"0"),o=Ke[l]||"",n='<svg width="60" height="14"><line stroke="#ff7f00" stroke-width="1" ';o&&(n+='stroke-dasharray="'+o+'" '),n+='x1="0%" y1="60%" x2="100%" y2="60%"/></svg>',Pt.innerHTML=n,i[0]=o,(a=a.slice(0))[1]=i,a[0]<0&&(fe=o),r.duals["svg.cfg"]=a}}}}function Z(t,e){if(Nt&&oe){var a=Nt.componentOf(oe);if(a){var r=a.componentOf("txt");if(r){var i=0==e?"default-align_center-right":1==e?"align_center-right-default":"right-default-align_center",l=r.state.klass||"",o=kt.mergeClass(r.$gui.className||"",l,i);if(o!==l){var n=a.elementOf("txt");if(!n||!n.props["marked."])return;n=vt.cloneElement(n,{"html.":r.state["html."]||"",klass:o}),a.setChild("-txt",function(t){a.setChild(n)})}}}}}function Q(t,e,a){if(Nt){var r=Object.assign({},t.props.style,{zIndex:a+""}),i=t.fullClone({style:r});Nt.setChild("-"+e,function(t){Nt.setChild(i)})}}function tt(t){if(Nt&&oe){var e=Nt.componentOf(oe);if(e){var a=parseInt(e.state.style.zIndex||"0"),r=-999;bt.eachComponent(Nt,function(t){if(e!==t){var a=parseInt(t.state.style.zIndex||"0");a>r&&(r=a)}}),a>r||Q(e,oe,Math.min(999,r+1))}}}function et(t){if(Nt&&oe){var e=Nt.componentOf(oe);if(e){var a=parseInt(e.state.style.zIndex||"0"),r=999;bt.eachComponent(Nt,function(t){if(e!==t){var a=parseInt(t.state.style.zIndex||"0");a<r&&(r=a)}}),a<r||Q(e,oe,Math.max(-999,r-1))}}}function at(t){if(Nt&&oe){var e=Nt.componentOf(oe);if(e){var a=oe;g();var r=[];bt.eachComponent(Nt,function(t){if(t!==e){var i,l=t.state["svg.cfg"];if(Array.isArray(l)&&Array.isArray(i=l[1])){var o=i[1];if(Array.isArray(o))for(var n=o.length-1;n>=0;n--){var s=o[n],f=s[0];s[2]===a?(r.push("-"+f),o.splice(n,1)):f===a&&o.splice(n,1)}}}});var i=e.state["svg.cfg"];if(Array.isArray(i)){var l,o=i[1];if(Array.isArray(o)&&Array.isArray(l=o[1]))for(var n,s=0;n=l[s];s++)r.push("-"+n[0])}r.push("-"+a),Nt.setChild.apply(Nt,r)}}}function rt(t){function e(t,e){for(var a=t.split(/ +/),r=a.length-1;r>=0;){var l=a[r];Pe.indexOf(l)>=0&&(e&&(i=l),a.splice(r,1)),r-=1}return a.join(" ")}if(Nt&&oe){var a=Nt.componentOf(oe),r=a&&a.componentOf("txt");if(r){var i="",l=(r.state.klass||"").trim();l=e(l,!0);var o=window.prompt("Modify klass",l);if("string"==typeof o&&(o=e(o.trim(),!1),i&&(o=i+" "+o),(o=o.trim())!==r.state.klass)){var n=a.elementOf("txt");if(!n||!n.props["marked."])return;n=vt.cloneElement(n,{"html.":r.state["html."]||"",klass:o}),a.setChild("-txt",function(t){a.setChild(n)})}}else if(a){var s=window.prompt("Input text","text");"string"==typeof s&&(a.duals["html."]=s.trim(),g())}}}function it(t,e,a,r){var i=t.state["svg.cfg"],l={key:a,left:t.state.left+4,top:t.state.top+4,width:t.state.width,height:t.state.height,rotate:t.state.rotate,stroke:t.state.stroke,style:{strokeColor:t.state.style.strokeColor||"#888",fillColor:t.state.style.fillColor||"#eee"}};if(Array.isArray(i)){var o=(i=i.slice(0))[1];Array.isArray(o)&&(i[1]=o=o.slice(0),o.length>=2&&(o[1]=0)),l["svg.cfg"]=i}var n=null,s=t.componentOf("txt");if(s&&1==t.$gui.comps.length){var f=t.$gui.comps[0];f&&f.props["marked."]&&(f=vt.cloneElement(f,{"hookTo.":void 0,"html.":s.state["html."]||""}),l["html."]="",n=vt.cloneElement(e,l,f))}n||(n=vt.cloneElement(e,l)),Nt.setChild(n,function(t){t&&r()})}function lt(t){if(!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&Nt&&oe){var e=Nt.componentOf(oe),a=Nt.elementOf(oe);if(e&&a){var r="auto"+(Zt+=1),i=t.clientX,l=t.clientY;it(e,a,r,function(){var t=Nt.componentOf(r);t&&(_e=t,Le=i+4,$e=l+4,qe=t.state.left,ze=t.state.top)})}}}function ot(t){if(!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&Nt&&oe){var e=Nt.componentOf(oe);if(e){var a=e.getHtmlNode();if(a){var i=r(a);je=e,Je=e.state.rotate||0,We=X(i.left+i.width/2,i.top+i.height/2,t.clientX,t.clientY)}}}}function nt(t){if(!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&Nt&&oe){var e=Nt.componentOf(oe);if(e){var a,i=t.target;i.classList.contains("resize")&&(a=e.getHtmlNode())&&(Bt.style.display="none",De=e,Re=i.getAttribute("data-position"),Fe=t.clientX,Be=t.clientY,Ue=r(a))}}}function st(t,e){if(!t.types)return!1;var a,r=t.types.length;for(a=0;a<r;a+=1)if(t.types[a]==e)return!0;return!1}function ft(t){Nt&&st(t.dataTransfer,"application/json")&&t.preventDefault()}function dt(t,e){var a=null;window.XMLHttpRequest?a=new XMLHttpRequest:window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP")),a&&(a.onreadystatechange=function(){4==a.readyState&&(200==a.status?e(null,a.responseText):e(new Error("XMLHttpRequest failed")),a=null)},a.open("GET",t,!0),a.send(null))}function ct(t){function e(){var t=s.scene,e=!1,a=100,r=60;if(Array.isArray(t)){var i=t[0];if(Array.isArray(i)&&"rewgt.DrawPaper"===i[0]){var l=i[1]||{};a=l.width||a,r=l.height||r,e=!0,t=t[1]}}else t=s.widget;if(Array.isArray(t)){var f=bt.loadElement(t);if(f){if(!f.props["svg.cfg"]){var d=(f.props.className||"").split(/ +/);if(d.indexOf("rewgt-panel")<0&&d.indexOf("rewgt-unit")<0||f.props["drawPaper."]||f.props["isScenePage."])return void alert("Error: invalid widget type!");var c=t.slice(0);"string"==typeof c[0]&&(c=[c]);var u=c[0],p=u[1];p||(u[1]=p={}),delete p["data-group.optid"];var g=p.width,y=p.height;p.width=.9999,p.height=.9999,a=isNaN(g)||g<12?a:g,r=isNaN(y)||y<12?r:y,e=!0;var v=h(c,0,1);f=bt.loadElement(["rewgt.SvgPanel",{klass:"nowrap-default-wrap_reverse items_center-end-stretch-default","html.":v,left:0,top:0,width:100,height:60,style:{strokeColor:"rgba(0,0,0,0)",fillColor:"rgba(0,0,0,0)"},"svg.cfg":[0,[],"lib/res/rect2.svg.json"]}])}var m={left:o,top:n,key:"auto"+(Zt+=1)};if(e)m.width=a,m.height=r;else{var g=f.props.width,y=f.props.height;m.width=isNaN(g)||g<12?a:g,m.height=isNaN(y)||y<12?r:y}f=vt.cloneElement(f,m),Nt.setChild(f)}}}if(Nt&&st(t.dataTransfer,"application/json")){t.stopPropagation(),t.preventDefault();var a=null,r=t.dataTransfer.getData("application/json")||"{}";try{a=JSON.parse(r)}catch(t){console.log(t)}if(a)if("image"!=a.dragType){if("template"==a.dragType){var i=Nt.state.offsetX||0,l=Nt.state.offsetY||0,o=t.clientX-i,n=t.clientY-Gt-l,s=a.option;"object"!=typeof s?void 0===s&&a.dragUrl&&dt(c=a.dragUrl+".json",function(t,a){if(t)alert("error: read JSON failed ("+c+").");else{try{s=JSON.parse(a)}catch(t){alert("error: parse JSON failed ("+c+").")}s&&s.name&&e()}}):s.name&&e()}}else{var f,d=oe&&Nt.componentOf(oe+".txt");if(d&&(f=d.state.style.background)){var c=a.dragUrl;a.clientWidth,a.clientHeight;if(!c)return;0==c.indexOf(At)&&c.length>At.length&&(c=c.slice(At.length));var u="url("+c+")";(f=f.replace(/\burl\([^)]+\)/,"").trim())&&(u+=" "+f),d.duals.style={background:u}}}}}function ht(t){if(Nt&&oe&&!(t.ctrlKey||t.altKey||t.metaKey)){var e=Nt.componentOf(oe);if(e){var a=e.getHtmlNode(),i=e.state["svg.cfg"];if(a&&Array.isArray(i)){var l;if(Ze=!1,"block"==Bt.style.display&&Array.isArray(l=i[1])){var o=r(a),n=e.state.stroke||3,s=Math.floor(2.5*n+.5);s*=Mt,Ze=!0,Qe=o.left+s+l[l.length-2]*Bt.rateX,ta=o.top+s+l[l.length-1]*Bt.rateY}Ve=e,Ge=t.shiftKey,ea=t.clientX,aa=t.clientY}}}}function ut(t){if(Nt&&oe&&!(t.ctrlKey||t.altKey||t.metaKey)){var e=Nt.componentOf(oe),a=Nt.elementOf(oe);if(e&&a){var r="auto"+(Zt+=1),i=t.clientX,l=t.clientY,o=t.shiftKey;it(e,a,r,function(){var t=Nt.componentOf(r);t&&(la=o,ra=e,ia=t,oa=i+4,na=l+4,sa=t.state.left,fa=t.state.top)})}}}function pt(t){if(Nt&&oe){var e=t.target;if(e.classList.contains("pointer")){var a=e.parentNode;if("block"==a.style.display&&!a.classList.contains("no-move")){var r=Nt.componentOf(oe);if(r){var i,l=r.state["svg.cfg"];if(Array.isArray(l)&&Array.isArray(i=l[1])){var o=parseInt(e.getAttribute("_pos")||"1"),n=o+o+5;n<i.length&&(ha=i[n-1],ua=i[n],da=r,ca=e,pa=t.clientX,ga=t.clientY,ya=parseInt(e.style.left),va=parseInt(e.style.top))}}}}}}function gt(t,e,a){var r=null,i=!0;!e&&ba&&Nt?(r=function(){if(!kt.containNode_)return null;var t=[],e=Nt.widget;if(kt.containNode_.dumpTree(t,e,e.parent.getPath()),Array.isArray(t)&&t.length){var a=t[0];if(!Array.isArray(a))return null;var r=a[0];if("rewgt.DrawPaper"===r)return[a];if(Array.isArray(r)){if(r.length>=2){var i=r[1];i.offsetX=Nt.state.offsetX,i.offsetY=Nt.state.offsetY}return a}}return null}(),Array.isArray(r)||(alert("Error: setup paper data failed"),r=null,i=!1)):i=!1;var l="[PROJECT_NAME]"+JSON.stringify({method:"onDialogExit",param:[t,i,ma,[i,wa,r]]});window.parent.window.postMessage(l,"*")}function yt(t,e,a){function r(){f>120?console.log("fatal error: load shadow-widget failed"):(f+=1,Nt?l():setTimeout(r,500))}function i(t,e){var a=t.length,r=0;a?t.forEach(function(t){var i=document.createElement("link");"onload"in i?(e&&(i.onload=function(t){(r+=1)>=a&&e()}),i.setAttribute("rel","stylesheet"),i.setAttribute("href",t),document.head.appendChild(i)):(i=document.createElement("img"),e&&(i.onerror=function(t){(r+=1)>=a&&e()}),i.setAttribute("src",t),document.body.appendChild(i))}):e&&e()}function l(){i(a,function(){ma=t,wa=n,ba=s;var e=bt.loadElement(s).props,a=vt.Children.toArray(e.children),r=e.offsetX||0,i=e.offsetY||0;Ot=e.defId||"pp0",St.innerHTML="("+r+","+i+")",e.klass&&bt.mergeClass(Nt,e.klass);var l=Object.assign({},e.style,{backgroundImage:"url(output/papergrid.png)",backgroundRepeat:"no-repeat",backgroundPosition:r%20+"px "+i%20+"px"});Nt.duals.style=l,Nt.duals.height=window.innerHeight-Gt,Nt.duals.offsetX=r,Nt.duals.offsetY=i,Nt.componentOf("//").listen("innerSize",function(t,e){Nt.duals.height=t[1]-Gt}),a.length?(a.push(o),Nt.setChild.apply(Nt,a)):Nt.reRender(o)})}function o(){var t=window.innerWidth-330;t=t>=460?Math.floor(.86*t):Math.min(360,window.innerWidth-330),Rt.style.width=t+"px",Dt.style.width=t-4+"px",Wt.style.left=t-24+"px";var e=Nt.getHtmlNode();if(e){var a=window.getComputedStyle(e).backgroundColor;if(a&&"transparent"!=a){var r=document.querySelector(".popline-frame");r&&(r.style.backgroundColor=a)}}var i=0,l=/^auto[0-9]+$/;bt.eachComponent(Nt,function(t){var e=t.duals.keyid+"";if(0==e.search(l)){var a=parseInt(e.slice(4));a>i&&(i=a)}}),Zt=i+1}var n,s,f=0,d=!0;if(!Array.isArray(e)||e.length<2||!Array.isArray(a))d=!1;else{if(e[2])return alert("Can not modify immutable paper"),void gt(!0,!0,!1);ie=kt.scanWtcFlag(),le=ie[1],ie=ie[0],n=e[0],s=e[1],Array.isArray(s)&&s.length||(d=!1)}if(d){var c=a.findIndex(function(t){return"sw_base.css"==t.split("/").pop()});c>=0&&a.splice(c,1),r()}else alert("Fatal error: unknown format"),gt(!0,!0,!1)}var vt=t("react"),mt=(t("react-dom"),t("shadow-widget")),wt=mt.$main,bt=mt.$utils,kt=mt.$creator,At="",xt="transform",Mt=4,Ct="lib/res/arrows.svg.json",Nt=null;wt.$onLoad.push(function(){if(Nt=mt.W(".body.paper").component,"/"!=(At=document.location.href.split("?")[0]).slice(-1)){var t=At.lastIndexOf("/");t>=0&&(At=At.slice(0,t+1))}var e=bt.vendorId||[],a=e[0]||"";"ie"==a?xt=e[1]?"transform":"msTransform":"firefox"==a||"opera"==a?xt="transform":"chrome"!=a&&"safari"!=a&&"webkit"!=a||(xt="WebkitTransform")});var Ot="",Tt=(o("#tool-bar"),o("#tool-grid")),It=o("button",Tt),Xt=o("input",Tt),St=o("span",Tt),Yt=o("#tool-opacity > input"),Et=o("#tool-frameWd > input"),Ht=o("#tool-arrowIdS"),Kt=o("#tool-arrowIdE"),Pt=o("#tool-lineId"),_t=o("#tool-alignleft"),Lt=o("#tool-alignmid"),$t=o("#tool-alignright"),qt=o("#linestyle_dropdown"),zt=o("#arrowstyle_dropdown"),jt=o("div.palette-items"),Jt=o("#text-area > .popline-frame"),Wt=o("#text-area > .popline-expand"),Dt=o("#text-area textarea"),Rt=Jt.parentNode,Ft=o("#react-container"),Bt=o("div.point-nodes"),Ut=o("div.halo"),Vt=o("div.free-transform"),Gt=70,Zt=0,Qt=document.querySelectorAll("#edit-btn > button");n(Qt[0],"click",function(t){k(!0)}),n(Qt[1],"click",function(t){k(!1)}),n(Qt=o("div.palette-items"),"click",l),n(Qt,"dblclick",l),n(Qt,"mouseup",T),n(It,"click",x),n(Xt,"change",M),n(Yt,"mousemove",q),n(Yt,"mouseout",z),n(Yt,"click",J),n(Yt,"change",W),n(Et,"mousemove",q),n(Et,"mouseout",z),n(Et,"click",R),n(Et,"change",F),n(Ht,"click",function(t){B(t,!0)}),n(Kt,"click",function(t){B(t,!1)}),n(Pt,"click",V),n(o("img",_t),"click",function(t){Z(t,0)}),n(o("img",Lt),"click",function(t){Z(t,1)}),n(o("img",$t),"click",function(t){Z(t,2)}),n("#tool-poptop > img","click",tt),n("#tool-pushbtm > img","click",et),n(qt,"click",G),n(zt,"click",U),n(Qt=o("#color-chart"),"click",l),n(Qt,"dblclick",I),n(Wt,"click",A),n(Dt,"change",c),n(Dt,"keydown",l),n(Dt,"drop",p),n(Bt,"mousedown",pt),n(Vt,"mousedown",nt),n(o(".remove",Ut),"click",at),n(o(".klass",Ut),"click",rt),n(o(".clone",Ut),"mousedown",lt),n(o(".link",Ut),"mousedown",ht),n(o(".fork",Ut),"mousedown",ut),n(o(".rotate",Ut),"mousedown",ot),n(Ft,"dragover",ft),n(Ft,"drop",ct),n(Ft,"mousedown",E),n(Ft,"mousemove",P),n(document.body,"mouseup",L),n(document.body,"click",function(t){f(),t.stopPropagation()}),n(document.body,"keydown",$);var te=null,ee={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ae="",re=/([A-Z])/g,ie=null,le=null,oe="",ne="rgb(119,119,119)",se="rgb(119,119,119)",fe="",de=3,ce=2,he=0,ue=0,pe=null,ge=!1,ye=0,ve=0,me=0,we=0,be=0,ke=0,Ae=null,xe=!1,Me=[],Ce=[],Ne=0,Oe=0,Te=0,Ie=0,Xe=null,Se=null,Ye=!0,Ee=["m0,50l100,0","m100,50l-100,40l30,-40l-30,-40z","m20,50c0,-16.57458 13.42542,-30 30,-30c16.57458,0 30,13.42542 30,30c0,16.57458 -13.42542,30 -30,30c-16.57458,0 -30,-13.42542 -30,-30z","m20,20l0,60l60,0l0,-60z","m20,80l60,-60m0,60l-60,-60","m50,0l0,100"],He=["m0,50l100,0","m0,50l100,40l-30,-40l30,-40z","m20,50c0,-16.57458 13.42542,-30 30,-30c16.57458,0 30,13.42542 30,30c0,16.57458 -13.42542,30 -30,30c-16.57458,0 -30,-13.42542 -30,-30z","m20,20l0,60l60,0l0,-60z","m20,80l60,-60m0,60l-60,-60","m50,0l0,100"],Ke=["","1,1","2,2","5,5","5,10","10,5","5,1","15,10,5,10,15"],Pe=["align_center-right-default","right-default-align_center","default-align_center-right","left-align_center-right","align_center-right-left","right-left-align_center"],_e=null,Le=0,$e=0,qe=0,ze=0,je=null,Je=0,We=0,De=null,Re="",Fe=0,Be=0,Ue=null,Ve=null,Ge=!1,Ze=!1,Qe=0,ta=0,ea=0,aa=0,ra=null,ia=null,la=!1,oa=0,na=0,sa=0,fa=0,da=null,ca=null,ha=0,ua=0,pa=0,ga=0,ya=0,va=0,ma=0,wa="",ba=null;if(window.parent&&window.parent.window!==window){window.addEventListener("message",function(t){try{"object"==typeof t&&t.data?(t=t.data,t=JSON.parse(t.slice(14))):t=null}catch(e){t=null,console.log(e)}"object"==typeof t&&("init"==t.method?yt(t.param[0],t.param[1],t.param[2]):t.method)},!1);var ka="[PROJECT_NAME]"+JSON.stringify({method:"onDialogLoad",param:[]});window.parent.window.postMessage(ka,"*")}});