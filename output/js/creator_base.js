window.W||(window.W=new Array,W.$modules=[]),W.$modules.push(function(a,b,c){function o(a,b,c){function d(a){a=a&&a.component,c&&c(a)}function p(a,b){function g(){var b=c.shift();if(!b)return d(a);a=a[b];var e=a&&a.component;if(!e)return d(null);var f=e.props["isTemplate."];if(!f||"none"!=(e.state.style||{}).display)return g();var h=3==f?"inline":2==f?"block":"flex",i=Object.assign({},e.state.style,{display:h});e.setState({style:i},g)}var c=b.split(".");if(!a){var e=c.shift();e||(e=c.shift()),a=n;var f=a&&a.component;if(!f||f.$gui.keyid!=e)return d(null)}return g()}var e=k.pathLevelInfo(b);if(!e)return d(null);var f=e[0],h=e[1];if(e[2]){if(a){var j=a.widget,l=j;if(h<0&&(l=l&&l.parent),l)return p(l,f)}}else if(-1==h){if(f)return p(null,f)}else{if(!a)return d(null);for(var j=a.widget;j&&h>0;){var m=j&&j.component;if(m&&m.props["isNavigator."]&&0==(h-=1))break;var o=j.parent;if(!o){h-=1,j=g;break}j=o}if(j&&0==h)return f?p(j,f):d(j)}return d(null)}function p(a,b,c){for(var d=c?0:1,e=a.split("."),f=b.split("."),h=Math.min(e.length,f.length),i="",j=0,k=0;k<h;k++){if(e[k]!=f[k]){k>0&&(j=k,i=e.slice(0,j).join("."));break}}var n="";if(i)if(f.length>=e.length&&j>=2&&j==e.length-d)n="//"+f.slice(j).join(".");else{for(var o=!1,p="",q=g.W(i);q;){var r=q.component;if(!r){q!==g&&(p="");break}if(r.props["isNavigator."]){o=!0;break}p="."+r.$gui.keyid+p,q=q.parent}if(!p&&!o)return"";n=f.slice(j).join("."),o?(p&&(p=p.slice(1)),n=p?"./"+p+(n?".":"")+n:"./"+n):p&&(n=p+(n?".":"")+n)}else n=b;return n}function q(a,b,c){function C(a){if(!a)return"";var b=l[a];if(b)return b;var c=a[0];if("#"==c&&4==a.length)return"#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3];if("#"==c&&7==a.length)return a;if("rgb"==a.slice(0,3)&&(a=a.slice(3).trim(),"("==a[0]&&")"==a.slice(-1))){var d=a.slice(1,-1).split(",");if(3==d.length)return b="#"+("0"+parseInt(d[0]).toString(16)).slice(-2),b+=("0"+parseInt(d[1]).toString(16)).slice(-2),b+=("0"+parseInt(d[2]).toString(16)).slice(-2)}return""}var d=a._;if(!d||!d._getGroupOpt)return null;var e,f,g=void 0,h=d._statedProp||[],j=d._silentProp||[],k=d._htmlText,m=d._className,n={name:m,desc:d._classDesc,option:d._getGroupOpt(a),doc:d._docUrl||"",linkPath:"",linkStyles:null},o=!1,p=0;g=a.state["data-unit.path"],void 0!==g?(p=2,o=!0,m="RefDiv"):void 0!==(g=a.state["data-span.path"])&&(p=3,o=!0,m="RefSpan"),o?(n.linkPath=g,n.linkStyles=a.props.styles):a.props["childInline."]?p=i.hasClass(a,"rewgt-unit")?2:3:i.hasClass(a,"rewgt-unit")&&(p=1),n.flag=p;var q,r;if(o){var s=a.props["link.props"];if(!s)return null;if(e=Object.assign({},s),f=e.style||{},delete e.style,delete e.styles,"string"==typeof(q=e["keyid."]))if("$"==q[0]){q=q.slice(1);var t=parseInt(q);t+""==q?(e["keyid."]=t,r=q=""):r=e["keyid."]=q}else r=q;else r=q=""}else{if(a.props["isReference."])return null;e=Object.assign({},a.props),f=e.style||{},delete e.style,q=a.$gui.keyid,r="string"!=typeof q?q="":q}if(h.forEach(function(b){e.hasOwnProperty(b)&&(e[b]=a.state[b])}),j.forEach(function(a){delete e[a]}),k){var u=o?e["html."]:a.state["html."];u&&"string"==typeof u&&(n["html."]=u)}delete e["html."],delete e.children,delete e["hasStatic."],e.key=r;var v={},w=!1,x=Object.keys(e),y=100,z={key:{propertyOrder:y,type:"string",default:q}};x.forEach(function(a){var d=a.indexOf(".");if(d>=0){if(d==a.length-1)return;return v[a]=e[a],void(w=!0)}if(!c||"$"!=a[0]){var f=e[a],g=!1;if(void 0!==f){if(0!=a.indexOf("data-")&&0!=a.indexOf("aria-")||(g=!0),"klass"==a){if("string"!=typeof f)return;var h=f.split(/[^-_a-zA-Z0-9]+/);if(0==h.length)return;return y+=1,void(z.klass={type:"array",options:{disable_array_reorder:!0},propertyOrder:y,items:{type:"string",format:"classname"},default:h})}var i=b[a],j="any",k=-1,l=null,m="";if(i){if(0==i.length)return;k=i[0],j=i[1]||"any",l=i[2]||null,m=i[3]||""}k<0&&(y+=1,k=y);var n={propertyOrder:k,default:f},o=!0;if(l&&(n.enum=l),m&&(n.description=m),g)n.type="string","string"!=typeof f&&(n.default=JSON.stringify(f));else if(null===f||"any"==j){"$"==a[0]&&(n.type="string");var p=typeof f;if("string"==p)f||(n.type="string");else{if("function"==p)return void console.log("warning: can not edit function property ("+a+")");n.default=JSON.stringify(f)}}else if("integer"==j){var q=parseInt(f);q+""==f+""?(n.type=j,n.default=q):o=!1}else"number"==j||"boolean"==j||"array"==j||"object"==j?"array"==j&&Array.isArray(f)?n.type=j:typeof f==j?n.type=j:o=!1:"string"==typeof f?(n.type="string","string"!=j&&(n.format=j)):o=!1;o||("string"!=typeof f&&(n.default=JSON.stringify(f)),console.log("warning: property ("+a+") is not match to expected type ("+j+").")),z[a]=n}}}),w&&(n.propsEx=v);var A=Object.keys(f);if(A.length){var B={};y+=1,z.style={type:"object",properties:B,propertyOrder:y},A.sort(),A.forEach(function(a){var b,c={type:"string",default:f[a]+""};if("color"==a||(b=a.indexOf("Color"))>0&&b+5==a.length){var d=C(c.default.trim());d&&(c.default=d,c.format="color")}B[a]=c})}return{type:"object",title:m+" - "+r,properties:z,wdgtOption:n}}var d=a("react"),e=a("react-dom"),f=d.createClass;f||console.log("fatal error: invalid React.createClass");var g=a("shadow-widget"),h=g.$main,i=g.$utils,j=g.$templates,k=g.$creator,l={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},m=null,n=null;h.$$onLoad.push(function(a){function h(a,b,c){if(3==b){if(3!=a)return i.instantShow("error: can not insert none-inline into inline widget."),!1}else if(2==b){if(0==a)return i.instantShow("error: can not insert panel into paragraph."),!1}else if(1==b){if(0==a){if(!c)return i.instantShow("error: can not insert panel into none-panel."),!1}else if(3==a)return i.instantShow("error: inline widget can not be inserted into panel or div."),!1}else if(3==a)return i.instantShow("error: inline widget can not be inserted into panel or div."),!1;return!0}function u(a,c,f,g,h,j){function P(){if(l){var a=B||0===B?B+"":"";f.linkPath&&"$"==a[0]&&(a=a.slice(1)),setTimeout(function(){a||(a=G.comps.length+G.removeNum-1);var b=p[a];b=b&&b.component,b&&(m=e.findDOMNode(b),h&&(r=b)),j&&j(l,m)},300)}else j&&j(l,m)}var l=!1,m=null,n=null,o=a.widget,p=o&&o.parent,q=p&&p.component;if(!q)return i.instantShow("warning: update property failed (out of date)."),P();if("object"!=typeof g)return P();var s=e.findDOMNode(a),t=s&&s.parentNode;if(t&&b(t))return i.instantShow("error: can not modify widget that under linker."),P();var u,v=g.klass;if(Array.isArray(v)){var w="";v.forEach(function(a){w&&(w+=" "),w+=(a||"undefined")+""}),v=w||void 0}else void 0!==v&&(v=null);delete g.klass;var x=g.style;if(x&&x instanceof Object){var y={},z=!1;u=Object.keys(x),u.forEach(function(a){z=!0;var b=x[a]+"";0==b.search(/^#[a-fA-F0-9]{6}$/)&&b[1]==b[2]&&b[3]==b[4]&&b[5]==b[6]&&(b="#"+b[1]+b[3]+b[5]),y[a]=b}),x=z?y:null}else x=null;delete g.style;var A=a.$gui.keyid,B=g.key,C=!1;if("string"==typeof B){if(B=B.trim())if(parseInt(B)+""==B)B="";else if(A!==B&&p[B])return i.instantShow("error: duplication of key name."),P();B||"string"!=typeof A||(C=!0)}else B="";delete g["keyid."],delete g.key,u=Object.keys(g),u.forEach(function(a){var b=g[a];if(0==a.indexOf("data-")||0==a.indexOf("aria-"))return void(g[a]=b+"");if(void 0!==b){var d=c[a],e="any";if(d&&d.length&&(e=d[1]),"any"==e&&"string"==typeof b&&"$"!=a[0]){var f=b.trim(),h=f[0];if(('"'==h||"'"==h)&&f.length>=2&&f.slice(-1)==h)g[a]=f.slice(1,-1);else if("["==h&&"]"==f.slice(-1)||"{"==h&&"}"==f.slice(-1))try{g[a]=JSON.parse(f)}catch(a){console.log("error: parse JSON failed, input string:"),console.log(f)}else if("null"==f)g[a]=null;else{var i=parseFloat(f);i+""===f&&(g[a]=i)}}}}),C?(g["keyid."]="",g.key=""):B?g["keyid."]=g.key=B:(g["keyid."]=B=A,g.key=B+""),x?g.style=x:a.props.style&&(g.style=void 0),null!==v&&(g.klass=v);var D=f.propsEx;D&&Object.keys(D).forEach(function(a){g.hasOwnProperty(a)||(g[a]=D[a])});var E="",F=["-"+A],G=q.$gui,H=G.compIdx[A];if("number"!=typeof H)return P();if(!(n=G.comps[H]))return P();if(f.linkPath){var I=2==f.flag?k.RefDiv__:k.RefSpan__;g.$=f.linkPath;var J;"string"==typeof A?("$"!=A[0]&&(E="$"+A,F.push("-"+E)),J=""===B?A:B):(E="$"+A,F.push("-"+E),J=B+""),J&&"$"!=J[0]&&(J="$"+J),J&&(g["keyid."]=g.key=J),f.linkStyles&&(g.styles=f.linkStyles),f["html."]&&!g.hasOwnProperty("html.")&&(g["html."]=f["html."]),n=d.createElement(I,g)}else f["html."]&&!g.hasOwnProperty("html.")&&(g["html."]=f["html."]),n=k.deepCloneReactEle(n,g,o,a);for(var K=G.comps.length,L="",M=H+1;M<K;M+=1){var N=G.comps[M],O=N&&i.keyOfElement(N);if(O&&O!=E){L=O;break}}F.push(function(){l=!0,L?q.setChild("+"+L,n,P):q.setChild(n,P)}),q.setChild.apply(q,F)}m=k.containNode_,n=k.topmostWidget_,i.instantShow!==m.instantShow&&setTimeout(function(){"function"==typeof m.instantShow&&(i.instantShow=m.instantShow)},300),m.closeModal=function(a){function b(){a&&a()}var c=n&&n.component;if(!c)return b();var e=d.createElement(f(j.Panel._extend()),{"hookTo.":n,key:"$pop","keyid.":"$pop",left:0,top:0,width:0,height:0,style:{position:"absolute",zIndex:3016,overflow:"visible"}});c.setChild("$pop",e,b)},m.topmostNode=function(){var a=n&&n.component;return a?e.findDOMNode(a):null},m.pluginCss=function(){var a=[];return(g.$css||[]).forEach(function(b){if(Array.isArray(b)){var c=b[0],d=b[1];!d||"pseudo"!=c&&"basic"!=c&&"lazy"!=c||a.push(d+"")}}),a},m.getWidgetNode=function(a,b,c){function f(a){c&&c(a,d)}var d=!1;if(!a)return f(null);var h=null,i=a[0],j=("."==i||"/"==i)&&"/"!=a[1];if(b&&!j&&(h=g.W(b),!(h=h&&h.component)))return f(null);o(h,a,function(a){var b=null;a&&(d=!!a.props["isReference."],b=e.findDOMNode(a)),f(b)})},m.getDocHtml=function(a){var b=[];if(m.dumpTree(b=[]),1==b.length){var c=b[0];if(a){var d="",e=c[0];if(Array.isArray(e))for(var g,f=1;g=c[f];f++){var h=m.streamTree(g,0,1);h&&(d+=h)}return d}return m.streamTree(c,0,1)}return""},m.resetRootShow=function(a){var b=n,c=b&&b.component;if(c){var d=c.$gui.comps,e=[];d.forEach(function(a){if(a){var c=i.keyOfElement(a);if(c&&"$pop"!=c){var d=b[c];if(d=d&&d.component)if("absolute"==(d.state.style||{}).position)d.setState({style:Object.assign({},d.state.style,{display:"none"})});else{var f=i.hasClass(d,"rewgt-panel")?"flex":"block";e.push([d,f])}}}}),e.forEach(function(a){var b=a[1];a=a[0],a.setState({style:Object.assign({},a.state.style,{display:b})})})}a&&setTimeout(function(){a()},0)},m.showRootPage=function(a,b){function d(){b&&b(c)}var c="";if(!g.__design__||"$pop"==a)return d();var f=n,h=f&&f.component;if(h){var j=f[a];if(!(j=j&&j.component))return d();var k=e.findDOMNode(j);k&&(k.classList.contains("rewgt-panel")?c="Panel":k.classList.contains("rewgt-unit")?c="Unit":k.classList.contains("rewgt-inline")&&(c="Span"),c&&(k.hasAttribute("data-temp.type")?c="Template":k.classList.contains("rewgt-scene")&&(c="ScenePage")));var l=!1;"absolute"==(j.state.style||{}).position&&(l=!0);var m=h.$gui.comps,o=[];m.forEach(function(b){if(b){var c=i.keyOfElement(b);if(c&&"$pop"!=c){var d=f[c];if(d=d&&d.component){var e,g=i.hasClass(d,"rewgt-panel")?"flex":"block";e="absolute"==(d.state.style||{}).position?l&&c==a?g:"none":l?"none":g,"none"==e?d.setState({style:Object.assign({},d.state.style,{display:"none"})}):o.push([d,e])}}}}),o.forEach(function(a){var b=a[1];a=a[0],a.setState({style:Object.assign({},a.state.style,{display:b})})})}d()},m.removeWidget=function(a,b){if(a&&"string"==typeof a){var c=g.W(a),d=c&&c.component;if(d){var e=c.parent,f=d.$gui.keyid,h=e&&e.component;if(h)return void h.setChild("-"+f,function(a){b&&b(a)})}}else if(Array.isArray(a)&&a.length>=2){var i=n&&n[a[0]],j=i&&i.component;if(j&&j.props["isScenePage."]){var k=[];return a.slice(1).forEach(function(a){k.push("-"+a)}),k.push(function(a){b&&b(a)}),void j.setChild.apply(j,k)}}b&&b(!1)},m.listPageChild=function(a){var b=[],c=n&&n[a],d=c&&c.component;if(d&&d.props["isScenePage."]){(d.$gui.comps||[]).forEach(function(a){if(a){var d=i.keyOfElement(a);if("$"==d[0])return;var f=c[d];if(f=f&&f.component){var g=e.findDOMNode(f);g&&b.push([d,g])}}})}return b},m.listChildren=function(a){var b=[],c=[],d=-1,f="",h="#a00",j=!0,k=n;a&&(k=g.W(a))!==n&&(j=!1);var l=k&&k.component;if(l){var m=l.$gui.comps||[],o=l.props["isNavigator."];m.forEach(function(a){if(a){var f=i.keyOfElement(a),g=f&&k[f];if(g=g&&g.component){if(j||o)if(j){if("$"==f[0]){if("$pop"==f)return;if("$"==f[1]&&a.props["isTemplate."])return}g.props["isScenePage."]&&c.push([f,e.findDOMNode(g)]);var l=g.state.style||{};"absolute"==l.position&&"none"!=l.display&&(d=b.length,h=g.props["isTemplate."]?"#00f":"#a00")}else g.props["isPlayground."]&&(d=b.length);b.push(f)}}}),f=l._._desc(l)}return[f,h,d,b,c]},m.resizeWidget=function(a,b,c,d,f){var h,l=g.W(a),m=!1,n=l&&l.component;if(n&&(h=e.findDOMNode(n))){if(i.hasClass(n,["rewgt-panel","rewgt-unit"])){var o=h.getBoundingClientRect(),p=n.state.width,q=n.state.height;if((1==b||3==b)&&"number"==typeof p)if(p>0&&p<1){p>=.9999&&(p=1);var r=Math.max(0,o.width+c);0==r?r=.001:(r/=o.width/p)>=1&&(r=.9999),n.duals.width=r,m=!0}else p>=1&&(n.duals.width=Math.max(1,o.width+c),m=!0);if((2==b||3==b)&&"number"==typeof q)if(q>0&&q<1){q>=.9999&&(q=1);var s=Math.max(0,o.height+d);0==s?s=.001:(s/=o.height/q)>=1&&(s=.9999),n.duals.height=s,m=!0}else q>=1&&(n.duals.height=Math.max(1,o.height+d),m=!0)}else if(n.props["childInline."]){var o=h.getBoundingClientRect(),t={};1!=b&&3!=b||(t.width=Math.max(0,o.width+c)+"px",m=!0),2!=b&&3!=b||(t.height=Math.max(0,o.height+d)+"px",m=!0),m&&(n.duals.style=t)}if(m){var u=l.parent;return u=u&&u.component,void(u?k.renewWidgetSpared(u,!0,function(){n.reRender(function(){f&&f(m)})}):n.reRender(function(){f&&f(m)}))}}f&&f(m)},m.setSceneCurrent=function(a){n&&a.forEach(function(a){var b=a[0],c=a[1],d=n[b];(d=d&&d.component)&&d.props["isScenePage."]&&d.setSelected(c)})},m.hideTemplate=function(a,b){var c=g.W(a),d=c&&c.component;d&&d.props["isTemplate."]&&(b&&c.parent===n||d.setState({style:Object.assign({},d.state.style,{display:"none"})}))},m.showTemplate=function(a,b,c){function e(){c&&c(d)}var d=!1,f=g.W(a),h=f&&f.component;if(!h)return e();var i=h.props["isTemplate."];if(!i)return e();if(b&&f.parent===n)return e();var j=3==i?"inline":2==i?"block":"flex";d=!0,h.setState({style:Object.assign({},h.state.style,{display:j})},e)};var b=function(a){return!(!a||a===m)&&(!(!a.getAttribute("data-unit.path")&&!a.getAttribute("data-span.path"))||b(a.parentNode))};m.isUnderLinker=b;var c=function(a,b){for(;a&&a!==m;){if(a.classList.contains("rewgt-panel")||a.classList.contains("rewgt-unit")||a.classList.contains("rewgt-inline"))if(b>0)b-=1;else{var c,d=a.getAttribute("data-group.opt");if(d&&"all"!=(c=d.split("/")[1]||"all"))return c}a=a.parentNode}return"all"};m.getEditableFlag=c,m.bindLinker=function(a,c,f){function j(){f&&f(h)}function n(a){if(l=a.props["isReference."])return m=!0,!0;var b=a.props["data-unit.path"];return b?(l=1,!0):!!(b=a.props["data-span.path"])&&(l=2,!0)}var h=!1,l=0,m=!1;if(a==c)return i.instantShow("error: can not link to self."),j();var o=g.W(a),q=g.W(c),r=o&&o.component,s=q&&q.component;if(!r||!n(r))return i.instantShow("error: source widget is not a linker."),j();if(!s)return i.instantShow("error: invalid target widget."),j();if(s.props["isTemplate."])return i.instantShow("error: can not link to a template."),j();if(2==l){if(!s.props["childInline."]||i.hasClass(s,"rewgt-unit"))return i.instantShow("error: RefSpan can only link to inline widget."),j()}else if(!i.hasClass(s,["rewgt-panel","rewgt-unit"]))return i.instantShow("error: RefDiv can only link to: panel, div, paragraph."),j();"number"==typeof s.$gui.keyid&&i.instantShow("warning: link to numbered-key is not suggested.");var t=p(a,c,!1);if(!t)return j();var u=o.parent,v=u&&u.component;if(!v)return j();if(b(e.findDOMNode(v)))return i.instantShow("error: binding path disallowed under a linker."),j();var w=r.$gui.keyid,x=w+"",y=x;"$"!=x[0]&&(w=x="$"+x);var z,A=null,B=v.$gui,C=B.compIdx[y];if("number"==typeof C&&(A=B.comps[C]),!A)return j();var D={$:t,key:x,"keyid.":w};if(m)z=d.cloneElement(A,D);else{var E=2==l?k.RefSpan__:k.RefDiv__;z=d.createElement(E,Object.assign(r.props["link.props"]||{},D))}var F=B.comps[C+1],G=F&&i.keyOfElement(F);v.setChild("-"+y,function(){h=!0,G?v.setChild("+"+G,z,j):v.setChild(z,j)})},m.createWidget=function(a,f,j,l,o,p,q){function v(){if(q){if(r&&u)for(var c,a=Object.keys(u.$gui.compIdx),b=0;c=a[b];b+=1)if(!s.hasOwnProperty(c)&&"$"!=c[0]){var d=u.widget,f=d&&d[c],g=f&&f.component;g&&(t=e.findDOMNode(g));break}q(r,t)}}function Z(){if(u=l?y:A,b(e.findDOMNode(u)))return i.instantShow("error: can not add widget to a linker."),v();var a=O.props["data-unit.path"],c=O.props["data-span.path"],g="",h="string"==typeof a?"data-unit.path":"string"==typeof c?"data-span.path":"";if(h){if(u.widget===n)return i.instantShow("error: can not use linker under topmost widget."),v();g=c||a,g||i.instantShow("warning: link path is empty.")}var j=i.keyOfElement(O),k=!1,m=!1;j&&"string"==typeof j?((m=0==j.search(/^auto[0-9]+$/))||parseInt(j)+""===j)&&(k=!0):k=!0;var q=!1;k?q=!0:"number"==typeof u.$gui.compIdx[j]&&(q=!0);var t=S&&!U;if(q){var w={"keyid.":"",key:""};if(m&&u.props["isScenePage."]){for(var x=u.$gui.removeNum+u.$gui.comps.length,z="auto"+x;"number"==typeof u.$gui.compIdx[z];)x+=1,z="auto"+x;w["keyid."]=w.key=z}h&&(w[h]=g),t&&(w.left=o,w.top=p),f&&(w["data-group.optid"]=f+""),O=d.cloneElement(O,w)}else if(h||t||f){var w={};h&&(w[h]=g),t&&(w.left=o,w.top=p),f&&(w["data-group.optid"]=f+""),O=d.cloneElement(O,w)}r=!0,l?(Object.assign(s,u.$gui.compIdx),u.setChild(O,v)):(Object.assign(s,u.$gui.compIdx),u.setChild("+"+y.$gui.keyid,O,v))}var r=!1,s={},t=null,u=null,w=null;if(j)w=g.W(j);else{m.children[0]&&(w=n,j=m.frameInfo.rootName,l=!0)}var y=w&&w.component,z=w&&w.parent,A=z&&z.component;if(!y||!l&&!A)return i.instantShow("error: invalid target widget."),v();var B=e.findDOMNode(y);if(B&&"all"!=c(B,l?0:1))return i.instantShow("error: insert target is disallowed."),v();if(!a[0]){var C=a[1],D=C&&C.html;if(Array.isArray(D)){var E=l?y:A;if((t=e.findDOMNode(E))&&b(t))return i.instantShow("error: can not add widget to a linker."),v();var F,G=D.join(""),H=document.createElement("div");if(H.innerHTML=G,(F=H.children.length)>0){for(var I=[],J=g.$staticNodes.push(I)-1,K=0;K<F;K+=1)I.push(H.children[K]);var L=E.$gui,M=L.comps.length+L.removeNum,N=J+"",C={"keyid.":M,key:M+"",className:"rewgt-static",name:N};g.__design__&&(C.onMouseDown=k.staticMouseDown,C.onDoubleClick=k.staticDbClick.bind(E));var O=d.createElement(E.props["childInline."]?"span":"div",C),P=L.compIdx;if(J=-1,l||(J=P[y.$gui.keyid]),"number"==typeof J&&J>=0){var P=P;for(var Q in P){var R=P[Q];R>=J&&(P[Q]=R+1)}L.comps.splice(J,0,O)}else J=L.comps.push(O)-1;P[M]=J,r=!0,E.reRender(function(){if(t){var a=t.querySelector('.rewgt-static[name="'+N+'"]');if(a)for(var c,b=0;c=I[b];b++)a.appendChild(c)}})}return void(q&&setTimeout(function(){q(r,t)},0))}}var O=i.loadElement(a);if(!O)return v();var S=null,T=null,U=O.props["isScenePage."];if(y.props["isScenePage."])S=y,T=w;else if(A&&A.props["isScenePage."])if(l){if(U)return i.instantShow("error: ScenePage can only insert into topmost widget."),v()}else S=A,T=z;var V,W=" "+O.props.className+" ",X=W.indexOf(" rewgt-panel ")>=0?0:W.indexOf(" rewgt-unit ")>=0?1:3;if(1==X&&O.props["childInline."]&&(X=2),S){if(T.parent!==n||!n.component)return i.instantShow("error: invalid target ScenePage."),v();if(V=0,w=T,y=S,U)return z=n,A=n.component,l=!1,Z();if(3==X)return i.instantShow("error: only panel, div, paragraph can add to ScenePage."),v();z=null,A=null,l=!0}else{if(U&&(w!==n||!l))return i.instantShow("error: ScenePage can only hook to topmost widget."),v();V=y.$gui.isPanel||w===n?0:i.hasClass(y,"rewgt-unit")?1:3,1==V&&y.props["childInline."]&&(V=2);var Y=!1;if(1==V&&y.props["isTableRow."]&&(Y=!0),!l){if(w===n||!A)return void i.instantShow("error: can not insert before topmost widget.");V=A.$gui.isPanel||z===n?0:i.hasClass(A,"rewgt-unit")?1:3,1==V&&A.props["childInline."]&&(V=2)}if(!h(X,V,Y))return v()}return Z()},m.copyWidget=function(a,d,f,h,j,l,m){function H(){var a=t.$gui,c=a.compIdx[r.$gui.keyid],d="number"==typeof c&&a.comps[c];if(!d)return I();if(E=f?v:x,b(e.findDOMNode(E)))return i.instantShow("error: can not add target widget under a linker."),I();var g=t.props["isScenePage."]&&!A,y=d.props["data-unit.path"],z=d.props["data-span.path"],B="",F="string"==typeof y?"data-unit.path":"string"==typeof z?"data-span.path":"";if(F){if(E.widget===n)return i.instantShow("error: can not use linker under topmost widget."),I();if((f?u:w)!==s)return i.instantShow("error: can not move linked-linker to another widget, use unlinked-linker instead."),I();if(!(B=z||y))return i.instantShow("warning: invalid link path."),I()}var G=i.keyOfElement(d),H=!1,J=!1;G&&"string"==typeof G?((J=0==G.search(/^auto[0-9]+$/))||parseInt(G)+""===G)&&(H=!0):H=!0;var K=!1;if(H?K=!0:h||"number"==typeof E.$gui.compIdx[G]&&(K=!0),K&&J&&C&&h&&!f){var L="+"+v.$gui.keyid;return void E.setChild("-"+G,function(){o=!0,E.setChild(L,d,function(){var a=E.widget,b=a&&a[G],c=b&&b.component;c&&(p=e.findDOMNode(c)),m&&m(o,p)})})}var M=k.getCompRenewProp(r)||{};if(K)if(J&&(E.props["isScenePage."]||C)){for(var N=E.$gui.removeNum+E.$gui.comps.length,O="auto"+N;"number"==typeof E.$gui.compIdx[O];)N+=1,O="auto"+N;M["keyid."]=M.key=O}else M["keyid."]=M.key="";if(F&&(M[F]=B),C?(M.left=0,M.top=0):A&&(M.left=j,M.top=l),g&&(M.left=null,M.top=null),d=k.deepCloneReactEle(d,M,q,r),h&&(H||K||(f?u:w)!==s||(h=!1)),h&&b(e.findDOMNode(t)))return i.instantShow("error: can not remove source widget under a link."),I();o=!0,Object.assign(D,E.$gui.compIdx),f?E.setChild(d,I):E.setChild("+"+v.$gui.keyid,d,I)}function I(){if(o)for(var c,a=Object.keys(E.$gui.compIdx),b=0;c=a[b];b+=1)if(!D.hasOwnProperty(c)&&"$"!=c[0]){var d=E.widget,f=d&&d[c],g=f&&f.component;g&&(p=e.findDOMNode(g));break}o&&h?t.setChild("-"+r.$gui.keyid,function(){m&&m(o,p)}):m&&m(o,p)}var o=!1,p=null,q=g.W(a),r=q&&q.component,s=q&&q.parent,t=s&&s.component;if(!r||!t)return i.instantShow("error: invalid source widget."),I();var u=g.W(d),v=u&&u.component,w=u&&u.parent,x=w&&w.component;if(!v||!x)return i.instantShow("error: invalid target widget."),I();if(h){var y=e.findDOMNode(r);if(y&&"all"!=c(y,1))return i.instantShow("error: move source widget is disallowed."),I()}var z=e.findDOMNode(v);if(z&&"all"!=c(z,f?0:1))return i.instantShow("error: insert target is disallowed."),I();var A=null,B=null,C=r.props["isScenePage."];if(v.props["isScenePage."])A=v,B=u;else if(x.props["isScenePage."])if(f){if(C)return i.instantShow("error: ScenePage can only insert into topmost widget."),I()}else A=x,B=w;var F,D={},E=null,G=r.$gui.isPanel?1:i.hasClass(r,"rewgt-unit")?2:3;if(A){if(B.parent!==n||!n.component)return i.instantShow("error: invalid target ScenePage."),I();if(F=1,u=B,v=A,w=n,x=n.component,C)return h&&r===A?(i.instantShow("warning: ignore moving ScenePage to same place."),I()):(f=!1,H());if(f=!0,1!=G&&2!=G)return i.instantShow("error: only panel, div, paragraph can move to ScenePage."),I()}else{if(C)return i.instantShow("error: ScenePage can only hook to topmost widget."),I();if(F=v.$gui.isPanel?1:i.hasClass(v,"rewgt-unit")?2:3,f){if(3==F&&3!=G)return i.instantShow("error: can not append none-inline to inline widget."),I();if(1==F&&3==G)return i.instantShow("error: can not append inline widget to panel."),I()}else{if(3==F&&3!=G)return i.instantShow("error: can not insert none-inline before inline widget."),I();if(3!=F&&3==G)return i.instantShow("error: can not insert inline before none-inline widget."),I()}}return H()},m.setWdgtZIndex=function(a,c,d){function h(){d&&d(f)}var f=!1,j=a&&g.W(a),k=j&&j.parent;if(j=j&&j.component,k=k&&k.component,!j||!k)return h();if(b(e.findDOMNode(k)))return i.instantShow("error: can not change z-index under a link."),h();var l=Object.assign({},j.state.style);l.zIndex=c+"",j.props.style&&(j.props.style.zIndex=l.zIndex),f=!0,j.setState({style:l},h)},m.getGroupOpt=function(a){var b=a;if("string"==typeof a){var c=g.W(a);b=c&&c.component}return b&&b._?b._._getGroupOpt(b):null};var l=0,r=null,s={},t={};m.widgetSchema=function(a,b,d){var f=a;if("string"==typeof a){var h=g.W(a);f=h&&h.component}if(!f||!f.props)return null;if(!b){var i=f._._getSchema(f);return[i,q(f,i,d)]}var j=e.findDOMNode(f),k="all";if(j&&(k=c(j,1)),"none"==k)return[0];var i=f._._getSchema(f),m=q(f,i,d);if(!m)return null;if(m.properties&&!m.properties.style&&(m.properties.style={type:"object",propertyOrder:200,default:{}}),t=m.wdgtOption,r=f,s=i,l+=1,delete m.wdgtOption,"some"==k){var n={},o=Object.keys(m.properties||{});o.forEach(function(a){"key"!=a&&"klass"!=a&&"style"!=a&&0!=a.indexOf("data-")&&0!=a.indexOf("aria-")||(n[a]=m.properties[a])}),m.properties=n;var p=m.options||{};p.disable_properties=!0,m.options=p}var o=[],u=[];Object.keys(s).forEach(function(a){var b=s[a];Array.isArray(b)&&u.push([b[0]||0,a])}),u.sort(function(a,b){return a[0]-b[0]}),u.forEach(function(a){o.push(a[1])});var v=t.option.baseUrl||"";return[l,m,{name:t.name,doc:t.doc,flag:t.flag,baseUrl:v},o,f._._htmlText&&!f.props["marked."]]},m.saveWdgtProp=function(a,b,c,d,e){"string"==typeof a&&(a=g.W(a),a=a&&a.component),a&&a.props?u(a,b,c,d,!1,e):e&&e(!1,null)},m.updateWdgtProp=function(a,b,c){l==a&&r?u(r,s,t,b,!0,c):c&&c(!1,null)},m.saveCompStyles=function(a,c,f,h){function C(){h&&setTimeout(function(){var a=n[q];a=a&&a.component,a&&(l=e.findDOMNode(a)),h(j,l)},300)}var j=!1,l=null;if("string"==typeof a&&(a=g.W(a),a=a&&a.component),!a||!a.props)return C();var m=a.widget,n=m&&m.parent,o=n&&n.component,p=null,q=a.$gui.keyid,r="",s="string"==typeof q&&"$"==q[0]?q:"$"+q;if(o){var t=o.$gui.compIdx[q],u=o.$gui.comps;if("number"==typeof t)for(p=u[t++];t<u.length;){var v=u[t++],w=v&&i.keyOfElement(v);if(w&&w!=s){r=w;break}}}if(!p||!c.linkPath)return C();var x=e.findDOMNode(o);if(x&&b(x))return i.instantShow("error: can not modify widget under a linker."),C();var y=a._._statedProp||[],z=a._._silentProp||[],A=Object.assign({},p.props["link.props"]);y.forEach(function(b){A.hasOwnProperty(b)&&(A[b]=a.state[b])}),z.forEach(function(a){delete A[a]});var B=q+"";"$"!=B[0]&&(B="$"+B),A["keyid."]=A.key=B,A.$=c.linkPath,f?A.styles=f:delete A.styles,p=d.createElement(2==c.flag?k.RefDiv__:k.RefSpan__,A),o.setChild("-"+q,"-"+s,function(a){j=!0,r?o.setChild("+"+r,p,C):o.setChild(p,C)})},m.saveNodeContent=function(a,c,f){function E(){if(f){var a=m[p];a=a&&a.component,a&&(j=e.findDOMNode(a)),f(h,j)}}var h=!1,j=null;if("string"==typeof a&&(a=g.W(a),a=a&&a.component),!a||!a.props)return E();var l=a.widget,m=l&&l.parent,n=m&&m.component,o=null,p=a.$gui.keyid,q="";if(n){var r=n.$gui.compIdx[p],s=n.$gui.comps;if("number"==typeof r){o=s[r++];for(var t="string"==typeof p&&"$"==p[0]?p:"$"+p;r<s.length;){var u=s[r++],v=u&&i.keyOfElement(u);if(v&&v!=t){q=v;break}}}}if(!o)return E();var w=e.findDOMNode(a),x=w&&w.parentNode;if(x&&b(x))return i.instantShow("error: can not save widget content under a linker."),E();if(w&&0==w.children.length){var y=a.props["link.props"];if(y){var z=k.RefDiv__,A=a.props["data-unit.path"];if(A||(A=a.props["data-span.path"],z=k.RefSpan__),!A)return E();var B=a._._statedProp||[],C=a._._silentProp||[];y=Object.assign({},y),B.forEach(function(b){y.hasOwnProperty(b)&&(y[b]=a.state[b])}),C.forEach(function(a){delete y[a]}),y.$=A,c?y["html."]=c:delete y["html."];var D=p+"";"$"!=D[0]&&(D="$"+D),y.key=y["keyid."]=D,o=d.createElement(z,y),n.setChild("-"+p,"-"+D,function(a){h=!0,q?n.setChild("+"+q,o,E):n.setChild(o,E)})}else{var y=k.getCompRenewProp(a);if(!y)return E();y["html."]=c||void 0,y.key=p+"",y["keyid."]=p,o=k.deepCloneReactEle(o,y,l,a),n.setChild("-"+p,function(a){h=!0,q?n.setChild("+"+q,o,E):n.setChild(o,E)})}}else E()},m.onlyScenePage=function(){var a=n,b=0,c=0;return a=a&&a.component,a&&a.$gui.comps.forEach(function(a){var d=a&&i.keyOfElement(a);if(d&&"$pop"!=d){if(a.props["isTemplate."])return;a.props["isScenePage."]?b+=1:c+=1}}),b>0&&0==c},m.selectMultWdgt=function(a,b,c,d,f){function q(a,b,c,d,e,f,g,h){return a<g&&b<h&&c>=e&&d>=f?1:0}function r(a,b,c,d,e,f,g,h){var i=e+g,j=f+h;return e>=a&&f>=b&&i<c&&j<d?1:0}var g=[],h=n&&n[a],j=h&&h.component;if(j&&j.props["isScenePage."]){var k=c>=f&&b>=d,l=Math.min(b,d),m=Math.min(c,f),o=Math.max(b,d),p=Math.max(c,f);j.$gui.comps.forEach(function(a){if(a){var b=i.keyOfElement(a),c=b&&"$"!=b[0]&&h[b];if(c=c&&c.component){var d=e.findDOMNode(c);if(d){var f=d.getBoundingClientRect();if(0==f.width&&0==f.height)return;if(parseInt(d.style.zIndex||0)<=-999)return;k?q(l,m,o,p,f.left,f.top,f.left+f.width,f.top+f.height)&&g.push([b,f.left,f.top,f.width,f.height]):r(l,m,o,p,f.left,f.top,f.width,f.height)&&g.push([b,f.left,f.top,f.width,f.height])}}}})}return g},m.moveSceneWdgt=function(a,b,c){var d=[];if("string"==typeof a){var e=g.W(a),f=e&&e.component;if(f){var h=f.state.left,i=f.state.top;f.setState({left:"number"!=typeof h?null:h+b,top:"number"!=typeof i?null:i+c}),d.push(f.$gui.keyid+"")}}else if(Array.isArray(a)&&a.length>=2){var j=a[0],e=n&&n[j],k=e&&e.component;k&&k.props["isScenePage."]&&a.slice(1).forEach(function(a){var f=e[a],g=f&&f.component;if(g){d.push(a);var h=g.state.left,i=g.state.top;g.setState({left:"number"!=typeof h?null:h+b,top:"number"!=typeof i?null:i+c})}})}return d};var v="SHADOW_WIDGET_COMPONENT";m.dumpWidget=function(a,b){function e(){b&&b(c,d)}var c=!1,d="";try{var f=null,h=",0,";if(Array.isArray(a)){var i=a[0],j=n&&n[i],k=j&&j.component;if(k&&k.props["isScenePage."]){h=",1,",f=[];for(var o,l=1;o=a[l];l+=1){var p=j[o];if(p){var q=[];m.dumpTree(q,p,""),1==q.length&&f.push(q[0])}}0==f.length&&(f=null)}}else if("string"==typeof a&&a){var j=g.W(a);j&&(f=[],m.dumpTree(f,j,""),1!=f.length&&(f=null))}f&&(d=v+h+JSON.stringify(f),c=!0)}catch(a){}e()},m.pasteWidget=function(a,c,f,j){function r(a){if(f&&l&&l==k)if("string"==typeof f){var b=g.W(f),c=b&&b.component;if(c){var d=b.parent,e=c.$gui.keyid,h=d&&d.component;h&&h.setChild("-"+e)}}else if(Array.isArray(f)){var r=f[0],s=f.slice(1),t=n&&n[r],u=t&&t.component;if(u){var v=s.map(function(a){return"-"+a});v.length&&u.setChild.apply(u,v)}}a&&i.instantShow(a),j&&setTimeout(function(){if(o&&q)for(var a=Object.keys(q.$gui.compIdx),b=a.length-1;b>=0;b--){var c=a[b];if("$"!=c[0]&&o.indexOf(c)<0){var d=q.widget[c];d=d&&d.component,d&&(p=d.getHtmlNode())}}j(l,m,p)},0)}function H(a,b){if(b){var c=w.parent,e=c&&c.component;return!!e&&(a=d.cloneElement(a,{"keyid.":"",key:""}),e.setChild("+"+q.$gui.keyid,a),!0)}var f=a.props["data-unit.path"],g=a.props["data-span.path"],h="",j="string"==typeof f?"data-unit.path":"string"==typeof g?"data-span.path":"";if(j){if(w===n)return i.instantShow("error: can not use linker under topmost widget."),!1;h=g||f}var k=!1,l=i.keyOfElement(a),m=!1;if(l&&"string"==typeof l?(m=0==l.search(/^auto[0-9]+$/),m||parseInt(l)+""===l?k=!0:"number"==typeof q.$gui.compIdx[l]&&(k=!0)):k=!0,k||j||x){var o={};if(k)if(m&&q.props["isScenePage."]){for(var p=q.$gui.removeNum+q.$gui.comps.length,r="auto"+p;"number"==typeof q.$gui.compIdx[r];)p+=1,r="auto"+p;o["keyid."]=o.key=r}else o["keyid."]=o.key="";j&&(o[j]=h),x&&(o.left=a.props.left||0,o.top=a.props.top||0),a=d.cloneElement(a,o)}return x?q.setChild(a):q.setChild("+"+u.$gui.keyid,a),!0}var k=0,l=0,m=!0,o=null,p=null,q=null,s=null;if(0!=c.indexOf(v)||"["==c[v.length+3])try{s=JSON.parse(c.slice(v.length+3))}catch(a){}if(!Array.isArray(s))return r("paste failed: invalid JSON input.");var t=g.W(a),u=t&&t.component;if(!u)return r();var w=null,x=u.props["isScenePage."];if(x)w=t,q=u,t=null,u=null;else{if(w=t.parent,!(q=w&&w.component))return r();q.props["isScenePage."]&&(x=!0)}"absolute"==(q.state.style||{}).position&&(m=!0);var y=[],z=!1;if(s.forEach(function(a){var b=i.loadElement(a);b?y.push(b):z=!0}),z)return r("paste failed: invalid format.");if(0==(k=y.length))return r("nothing to paste.");1==k&&x&&(o=Object.keys(q.$gui.compIdx));var A=0,B=!1;if(!x){if(b(e.findDOMNode(q)))return i.instantShow("error: can not paste widget to a linker."),r();1!=k&&(i.instantShow("warning: only one widget can be inserted into none-ScenePage."),y.splice(1),k=1),A=q.$gui.isPanel||w===n?0:i.hasClass(q,"rewgt-unit")?1:3,1==A&&q.props["childInline."]&&(A=2),1==A&&tarNodeObj.props["isTableRow."]&&(B=!0)}for(var D,C=0;D=y[C];C+=1){if(D.props["isScenePage."]){if(!x)return i.instantShow("error: ScenePage can only insert into topmost widget."),r();if(m=!0,!H(D,!0))return r();l+=1}else{var F=" "+D.props.className+" ",G=F.indexOf(" rewgt-panel ")>=0?0:F.indexOf(" rewgt-unit ")>=0?1:3;if(1==G&&D.props["childInline."]&&(G=2),!h(G,A,B))return r();if(!H(D,!1))return r();l+=1}}setTimeout(function(){r()},0)},m.firstChildOf=function(a,b){var c=g.W(a),d=c&&c.component;if(d)for(var f=d.$gui.comps,h=f.length,j=0;j<h;j+=1){var k=f[j],l=k&&i.keyOfElement(k);if(l){if(b&&"$"==l[0])continue;var m=c[l],n=m&&m.component;if(n)return e.findDOMNode(n)}}return null},a()})});